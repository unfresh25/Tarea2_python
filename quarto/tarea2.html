<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jorge Borja">

<title>PostgreSQL, Docker &amp; Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="tarea2_files/libs/clipboard/clipboard.min.js"></script>
<script src="tarea2_files/libs/quarto-html/quarto.js"></script>
<script src="tarea2_files/libs/quarto-html/popper.min.js"></script>
<script src="tarea2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tarea2_files/libs/quarto-html/anchor.min.js"></script>
<link href="tarea2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tarea2_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tarea2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tarea2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tarea2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #f8f9fa;
      }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.30.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>

<link rel="apple-touch-icon" sizes="180x180" href="Icon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="Icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="Icon/favicon-16x16.png">
<link rel="manifest" href="Icon/site.webmanifest">
<link rel="mask-icon" href="Icon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<link rel="stylesheet" href="style.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">PostgreSQL, Docker &amp; Python</h1>
            <p class="subtitle lead">Visualización Científica</p>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-heading">Afiliación</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://www.linkedin.com/in/jorgeborjas25/">Jorge Borja</a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://uninorte.edu.co/">
              Universidad del Norte
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">4 de abril de 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenido</h2>
   
  <ul class="collapse">
  <li><a href="#librerías" id="toc-librerías" class="nav-link active" data-scroll-target="#librerías">Librerías</a></li>
  <li><a href="#conexión-a-la-base-de-datos" id="toc-conexión-a-la-base-de-datos" class="nav-link" data-scroll-target="#conexión-a-la-base-de-datos">Conexión a la base de datos</a></li>
  <li><a href="#tabla-employees" id="toc-tabla-employees" class="nav-link" data-scroll-target="#tabla-employees">Tabla Employees</a>
  <ul class="collapse">
  <li><a href="#crear-una-tabla-llamada-employees-y-explicar-qué-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla" id="toc-crear-una-tabla-llamada-employees-y-explicar-qué-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla" class="nav-link" data-scroll-target="#crear-una-tabla-llamada-employees-y-explicar-qué-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla">Crear una tabla llamada employees y explicar qué tarea realiza la consulta realizada y mostrar en pantalla la tabla</a></li>
  <li><a href="#insertar-datos." id="toc-insertar-datos." class="nav-link" data-scroll-target="#insertar-datos.">Insertar datos.</a></li>
  </ul></li>
  <li><a href="#tabla-courses" id="toc-tabla-courses" class="nav-link" data-scroll-target="#tabla-courses">Tabla Courses</a>
  <ul class="collapse">
  <li><a href="#crear-la-tabla-courses" id="toc-crear-la-tabla-courses" class="nav-link" data-scroll-target="#crear-la-tabla-courses">Crear la tabla courses</a></li>
  <li><a href="#insertar-datos" id="toc-insertar-datos" class="nav-link" data-scroll-target="#insertar-datos">Insertar datos</a></li>
  <li><a href="#obtener-datos-mediante-queries" id="toc-obtener-datos-mediante-queries" class="nav-link" data-scroll-target="#obtener-datos-mediante-queries">Obtener datos mediante queries</a></li>
  </ul></li>
  <li><a href="#tabla-users" id="toc-tabla-users" class="nav-link" data-scroll-target="#tabla-users">Tabla Users</a>
  <ul class="collapse">
  <li><a href="#crear-la-base-de-datos-users" id="toc-crear-la-base-de-datos-users" class="nav-link" data-scroll-target="#crear-la-base-de-datos-users">Crear la base de datos <code>users</code></a></li>
  <li><a href="#insertar-datos-1" id="toc-insertar-datos-1" class="nav-link" data-scroll-target="#insertar-datos-1">Insertar datos</a></li>
  <li><a href="#obtener-datos-mediante-queries-1" id="toc-obtener-datos-mediante-queries-1" class="nav-link" data-scroll-target="#obtener-datos-mediante-queries-1">Obtener datos mediante queries</a></li>
  </ul></li>
  <li><a href="#tabla-cardano-usd" id="toc-tabla-cardano-usd" class="nav-link" data-scroll-target="#tabla-cardano-usd">Tabla Cardano USD</a>
  <ul class="collapse">
  <li><a href="#importar-los-datos-del-precio-de-cardano-usd-ada-usd" id="toc-importar-los-datos-del-precio-de-cardano-usd-ada-usd" class="nav-link" data-scroll-target="#importar-los-datos-del-precio-de-cardano-usd-ada-usd">Importar los datos del precio de <code>Cardano USD (ADA-USD)</code></a></li>
  <li><a href="#dibuje-un-gráfico-de-candlestick-para-la-criptomoneda" id="toc-dibuje-un-gráfico-de-candlestick-para-la-criptomoneda" class="nav-link" data-scroll-target="#dibuje-un-gráfico-de-candlestick-para-la-criptomoneda">Dibuje un gráfico de <code>candlestick</code> para la criptomoneda</a></li>
  <li><a href="#realice-un-análisis-exploratorio-eda-para-la-serie-de-tiempo" id="toc-realice-un-análisis-exploratorio-eda-para-la-serie-de-tiempo" class="nav-link" data-scroll-target="#realice-un-análisis-exploratorio-eda-para-la-serie-de-tiempo">Realice un análisis exploratorio <code>(EDA)</code> para la serie de tiempo</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="librerías" class="level1">
<h1>Librerías</h1>
<p>Para este proyecto trabajaremos con las librerías de <code>pyscopg2</code> para conectarnos a la base de datos de postgre que creaamos posteriormente en <code>Docker</code>; <code>pandas</code> para procesar los datos; <code>plotly</code>, <code>matplotlib</code> y <code>seaborn</code> para las gráficas; y <code>Scikit-learn</code> para realizar transformaciones en nuestros datos.</p>
<p><strong>Nota:</strong> Para instalar estas librerías, puede hacerlas mediante <code>pip install package_name</code> o puede usar clonar este repositorio de <a href="https://github.com/unfresh25/Tarea2_python">GitHub</a> y utilizar <code>pip install -r requirements.txt</code>.</p>
<div id="ecbfbec7" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> psycopg2 <span class="im">as</span> psy</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> psycopg2 <span class="im">import</span> Error</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">'white'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conexión-a-la-base-de-datos" class="level1">
<h1>Conexión a la base de datos</h1>
<p>Ahora, vamos a realizar la conexión a la base de datos de postgresql mediante la librería de <code>psycopg2</code> y veremos la versión con la que trabajaremos en postgre.</p>
<div id="8bdc3137" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>      user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  cursor.execute(<span class="st">"SELECT version();"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  record <span class="op">=</span> cursor.fetchone()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"You are connected to - "</span>, record, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (connection):</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      cursor.close()</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      connection.close()</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>You are connected to -  ('PostgreSQL 16.2 (Debian 16.2-1.pgdg120+2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit',) 

PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
<section id="tabla-employees" class="level1">
<h1>Tabla Employees</h1>
<section id="crear-una-tabla-llamada-employees-y-explicar-qué-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla" class="level2">
<h2 class="anchored" data-anchor-id="crear-una-tabla-llamada-employees-y-explicar-qué-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla">Crear una tabla llamada employees y explicar qué tarea realiza la consulta realizada y mostrar en pantalla la tabla</h2>
<div id="3e5b52f4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">"DROP TABLE IF EXISTS employees"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="st">        CREATE TABLE employees(</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="st">            employee_id INTEGER,</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="st">            first_name VARCHAR(20), </span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="st">            last_name VARCHAR(25), </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="st">            email VARCHAR(25), </span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="st">            phone_number VARCHAR(20), </span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="st">            hire_date DATE, </span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="st">            job_id VARCHAR(10), </span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="st">            salary NUMERIC(8,2), </span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="st">            commission_pct NUMERIC(2, 2), </span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="st">            manager_id INTEGER, </span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="st">            department_id INTEGER</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="st">        );</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Tabla creada con éxito"</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="st">        CREATE UNIQUE INDEX emp_emp_id_pk</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="st">        ON employees (employee_id);</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Índice creado con éxito"</span>)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="st">        ALTER TABLE employees ADD</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="st">        PRIMARY KEY (employee_id);</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Llave primaria agregada con éxito"</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Transacción realizada con éxito"</span>)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tabla creada con éxito
Índice creado con éxito
Llave primaria agregada con éxito
Transacción realizada con éxito
PostgreSQL connection is closed</code></pre>
</div>
</div>
<p>En el código anterior, se creó la tabla de empleados cuya llave primaria será la columna de <code>employee_id</code> la cual tiene un índice único llamado <code>emp_emp_id_pk</code>. Además, se tienen otras columnas que almacenarán la información del cliente como son su nombre, apellido, correo, salario, etc.</p>
</section>
<section id="insertar-datos." class="level2">
<h2 class="anchored" data-anchor-id="insertar-datos.">Insertar datos.</h2>
<div id="f0a278dc" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">"SELECT * FROM employees LIMIT 10;"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cursor.fetchall()</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">"SELECT count(1) FROM employees;"</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> cursor.fetchone()</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[]
(0,)
PostgreSQL connection is closed</code></pre>
</div>
</div>
<p>En el código anterior, en la primera consulta se obtienen los valores de todas las columnas registradas en la tabla <code>employees</code> con un límite de 10 filas a mostrar. Y, para la segunda consulta, obtenemos el número total de filas o registros de la tabla <code>employees</code>. Sin embargo, como la tabla no contiene registros de los empleados, esta nos devuelve, para la primera consulta, un vector vacío y un valor de 0, para la segunda consulta, dado que no tenemos información para mostrar.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/create_employees.png" class="img-fluid figure-img"></p>
<figcaption>Create employees table</figcaption>
</figure>
</div>
</section>
</section>
<section id="tabla-courses" class="level1">
<h1>Tabla Courses</h1>
<section id="crear-la-tabla-courses" class="level2">
<h2 class="anchored" data-anchor-id="crear-la-tabla-courses">Crear la tabla courses</h2>
<p>Crear la tabla de <code>courses</code> con las siguientes columnas:</p>
<ul>
<li><p>course_id - integer y primary key</p></li>
<li><p>course_name - valores alfanuméricos o de cadena de hasta 60 caracteres</p></li>
<li><p>course_author - nombre del autor de hasta 40 caracteres</p></li>
<li><p>course_status - published, draft, inactive.</p></li>
<li><p>course_published_dt - valor de tipo fecha.</p></li>
</ul>
<div id="88dcd16f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">"DROP TABLE IF EXISTS courses"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">            CREATE TABLE courses (</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">                course_id SERIAL PRIMARY KEY,</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">                course_name VARCHAR(60),</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">                course_author VARCHAR(40),</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">                course_status VARCHAR(10) CHECK (course_status IN ('published', 'draft', 'inactive')),</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">                course_published_dt date</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">            );</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Table created successfully in PostgreSQL"</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Table created successfully in PostgreSQL
PostgreSQL connection is closed</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/create_courses.png" class="img-fluid figure-img"></p>
<figcaption>Create courses table</figcaption>
</figure>
</div>
</section>
<section id="insertar-datos" class="level2">
<h2 class="anchored" data-anchor-id="insertar-datos">Insertar datos</h2>
<p>Inserte los datos en <code>courses</code> utilizando los datos proporcionados. Asegúrese de que el <code>id</code> es generado por el sistema. No olvide refrescar la información de la base de datos.</p>
<div id="70e98044" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="st">            INSERT INTO courses (course_name, course_author, course_status, course_published_dt)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="st">            VALUES </span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Programming using Python', 'Bob Dillon', 'published', '2020-09-30'),</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Data Engineering using Python', 'Bob Dillon', 'published', '2020-07-15'),</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Data Engineering using Scala', 'Elvis Presley', 'draft', NULL),</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Programming using Scala', 'Elvis Presley', 'published', '2020-05-12'),</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Programming using Java', 'Mike Jack', 'inactive', '2020-08-10'),</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Web Applications - Python Flask', 'Bob Dillon', 'inactive', '2020-07-20'),</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Web Applications - Java Spring', 'Mike Jack', 'draft', NULL),</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Pipeline Orchestration - Python', 'Bob Dillon', 'draft', NULL),</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Streaming Pipelines - Python', 'Bob Dillon', 'published', '2020-10-05'),</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Web Applications - Scala Play', 'Elvis Presley', 'inactive', '2020-09-30'),</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Web Applications - Python Django', 'Bob Dillon', 'published', '2020-06-23'),</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Server Automation - Ansible', 'Uncle Sam', 'published', '2020-07-05');</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Data inserted successfully"</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data inserted successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/select_courses.png" class="img-fluid figure-img"></p>
<figcaption>Insert courses data</figcaption>
</figure>
</div>
</section>
<section id="obtener-datos-mediante-queries" class="level2">
<h2 class="anchored" data-anchor-id="obtener-datos-mediante-queries">Obtener datos mediante queries</h2>
<p>En este apartado vamos a realizar algunos ejercicios de obtener datos directamente desde la base de datos.</p>
<section id="borre-todos-los-cursos-que-no-estén-en-modo-borrador-ni-publicados.-proporcione-la-sentencia-de-borrado-como-respuesta-para-este-ejercicio-en-el-jupyter-book.-para-validar-obtenga-el-recuento-de-todos-los-cursos-publicados-por-autor-y-asegúrese-de-que-la-salida-está-ordenada-en-forma-descendente-por-recuento." class="level3">
<h3 class="anchored" data-anchor-id="borre-todos-los-cursos-que-no-estén-en-modo-borrador-ni-publicados.-proporcione-la-sentencia-de-borrado-como-respuesta-para-este-ejercicio-en-el-jupyter-book.-para-validar-obtenga-el-recuento-de-todos-los-cursos-publicados-por-autor-y-asegúrese-de-que-la-salida-está-ordenada-en-forma-descendente-por-recuento.">Borre todos los cursos que no estén en <code>modo borrador ni publicados</code>. Proporcione la sentencia de borrado como respuesta para este ejercicio en el <code>Jupyter Book</code>. Para validar, obtenga el recuento de todos los cursos publicados por autor y asegúrese de que la salida está ordenada en forma descendente por recuento.</h3>
<p>Para borrar datos de una tabla debemos usar la sentencia <code>DELETE</code>, donde debemos especificar una tabla para borrar las filas y una condición en caso que querramos borrar datos específicos y no todos los registros. En nuestro caso, la sentencia que debemos usar sería <code>DELETE FROM courses WHERE course_status NOT IN ('draft', 'published')</code>.</p>
<div id="8973e954" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="st">            DELETE FROM courses</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">            WHERE course_status NOT IN ('draft', 'published');</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Deleted rows:"</span>, cursor.rowcount)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT course_author, count(course_name) as total_courses</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM courses</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="st">            GROUP BY course_author</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="st">            ORDER BY total_courses DESC;</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Author'</span><span class="sc">:&lt;20}{</span><span class="st">'Total Courses'</span><span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> records:</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        author, total_courses <span class="op">=</span> record</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>author<span class="sc">:&lt;20}{</span>total_courses<span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Operation done successfully"</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deleted rows: 3
Author              Total Courses  
Bob Dillon          5              
Elvis Presley       2              
Uncle Sam           1              
Mike Jack           1              

Operation done successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="tabla-users" class="level1">
<h1>Tabla Users</h1>
<section id="crear-la-base-de-datos-users" class="level2">
<h2 class="anchored" data-anchor-id="crear-la-base-de-datos-users">Crear la base de datos <code>users</code></h2>
<div id="902f0aec" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">"DROP TABLE IF EXISTS users"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="st">            CREATE TABLE users(</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st">                user_id SERIAL PRIMARY KEY,</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="st">                user_first_name VARCHAR(30),</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="st">                user_last_name VARCHAR(30),</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="st">                user_email_id VARCHAR(50),</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="st">                user_gender VARCHAR(1),</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="st">                user_unique_id VARCHAR(15),</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="st">                user_phone_no VARCHAR(20),</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="st">                user_dob DATE,</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="st">                created_ts TIMESTAMP</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="st">            );</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Table created successfully in PostgreSQL"</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Table created successfully in PostgreSQL
PostgreSQL connection is closed</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/create_users.png" class="img-fluid figure-img"></p>
<figcaption>Create users table</figcaption>
</figure>
</div>
</section>
<section id="insertar-datos-1" class="level2">
<h2 class="anchored" data-anchor-id="insertar-datos-1">Insertar datos</h2>
<div id="8260adde" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="st">            INSERT INTO users (</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="st">                user_first_name, user_last_name, user_email_id, user_gender, </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="st">                user_unique_id, user_phone_no, user_dob, created_ts</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="st">            ) </span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="st">            VALUES</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Giuseppe', 'Bode', 'gbode0@imgur.com', 'M', '88833-8759', </span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="st">            '+86 (764) 443-1967', '1973-05-31', '2018-04-15 12:13:38'),</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Lexy', 'Gisbey', 'lgisbey1@mail.ru', 'F', '262501-029', </span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="st">            '+86 (751) 160-3742', '2003-05-31', '2020-12-29 06:44:09'),</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Karel', 'Claringbold', 'kclaringbold2@yale.edu', 'F', '391-33-2823', </span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="st">            '+62 (445) 471-2682', '1985-11-28', '2018-11-19 00:04:08'),</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Marv', 'Tanswill', 'mtanswill3@dedecms.com', 'F', '1195413-80', </span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="st">            '+62 (497) 736-6802', '1998-05-24', '2018-11-19 16:29:43'),</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Gertie', 'Espinoza', 'gespinoza4@nationalgeographic.com', 'M', '471-24-6869', </span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="st">            '+249 (687) 506-2960', '1997-10-30', '2020-01-25 21:31:10'),</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Saleem', 'Danneil', 'sdanneil5@guardian.co.uk', 'F', '192374-933', </span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="st">            '+63 (810) 321-0331', '1992-03-08', '2020-11-07 19:01:14'),</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Rickert', 'O''Shiels', 'roshiels6@wikispaces.com', 'M', '749-27-47-52', </span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="st">            '+86 (184) 759-3933', '1972-11-01', '2018-03-20 10:53:24'),</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Cybil', 'Lissimore', 'clissimore7@pinterest.com', 'M', '461-75-4198', </span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="st">            '+54 (613) 939-6976', '1978-03-03', '2019-12-09 14:08:30'),</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Melita', 'Rimington', 'mrimington8@mozilla.org', 'F', '892-36-676-2', </span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="st">            '+48 (322) 829-8638', '1995-12-15', '2018-04-03 04:21:33'),</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Benetta', 'Nana', 'bnana9@google.com', 'M', '197-54-1646', </span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="st">            '+420 (934) 611-0020', '1971-12-07', '2018-10-17 21:02:51'),</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Gregorius', 'Gullane', 'ggullanea@prnewswire.com', 'F', '232-55-52-58', </span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a><span class="st">            '+62 (780) 859-1578', '1973-09-18', '2020-01-14 23:38:53'),</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Una', 'Glayzer', 'uglayzerb@pinterest.com', 'M', '898-84-336-6', </span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="st">            '+380 (840) 437-3981', '1983-05-26', '2019-09-17 03:24:21'),</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Jamie', 'Vosper', 'jvosperc@umich.edu', 'M', '247-95-68-44', </span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="st">            '+81 (205) 723-1942', '1972-03-18', '2020-07-23 16:39:33'),</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Calley', 'Tilson', 'ctilsond@issuu.com', 'F', '415-48-894-3', </span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="st">            '+229 (698) 777-4904', '1987-06-12', '2020-06-05 12:10:50'),</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Peadar', 'Gregorowicz', 'pgregorowicze@omniture.com', 'M', '403-39-5-869', </span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="st">            '+7 (267) 853-3262', '1996-09-21', '2018-05-29 23:51:31'),</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Jeanie', 'Webling', 'jweblingf@booking.com', 'F', '399-83-05-03', </span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="st">            '+351 (684) 413-0550', '1994-12-27', '2018-02-09 01:31:11'),</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Yankee', 'Jelf', 'yjelfg@wufoo.com', 'F', '607-99-0411', </span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="st">            '+1 (864) 112-7432', '1988-11-13', '2019-09-16 16:09:12'),</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Blair', 'Aumerle', 'baumerleh@toplist.cz', 'F', '430-01-578-5', </span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="st">            '+7 (393) 232-1860', '1979-11-09', '2018-10-28 19:25:35'),</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Pavlov', 'Steljes', 'psteljesi@macromedia.com', 'F', '571-09-6181', </span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="st">            '+598 (877) 881-3236', '1991-06-24', '2020-09-18 05:34:31'),</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Darn', 'Hadeke', 'dhadekej@last.fm', 'M', '478-32-02-87', </span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="st">            '+370 (347) 110-4270', '1984-09-04', '2018-02-10 12:56:00'),</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Wendell', 'Spanton', 'wspantonk@de.vu', 'F', null, </span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="st">            '+84 (301) 762-1316', '1973-07-24', '2018-01-30 01:20:11'),</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Carlo', 'Yearby', 'cyearbyl@comcast.net', 'F', null, </span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="st">            '+55 (288) 623-4067', '1974-11-11', '2018-06-24 03:18:40'),</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Sheila', 'Evitts', 'sevittsm@webmd.com', null, '830-40-5287',</span></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="st">            null, '1977-03-01', '2020-07-20 09:59:41'),</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Sianna', 'Lowdham', 'slowdhamn@stanford.edu', null, '778-0845', </span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="st">            null, '1985-12-23', '2018-06-29 02:42:49'),</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="st">            ('Phylys', 'Aslie', 'paslieo@qq.com', 'M', '368-44-4478', </span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="st">            '+86 (765) 152-8654', '1984-03-22', '2019-10-01 01:34:28');</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Data inserted successfully"</span>)</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data inserted successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/select_users.png" class="img-fluid figure-img"></p>
<figcaption>Insert users data</figcaption>
</figure>
</div>
</section>
<section id="obtener-datos-mediante-queries-1" class="level2">
<h2 class="anchored" data-anchor-id="obtener-datos-mediante-queries-1">Obtener datos mediante queries</h2>
<section id="obtenga-el-número-de-usuarios-creados-por-año.-utilice-la-tabla-de-usuarios-para-este-ejercicio." class="level3">
<h3 class="anchored" data-anchor-id="obtenga-el-número-de-usuarios-creados-por-año.-utilice-la-tabla-de-usuarios-para-este-ejercicio.">Obtenga el número de usuarios creados por año. Utilice la tabla de usuarios para este ejercicio.</h3>
<ul>
<li><p>La salida debe contener el año de 4 dígitos y el recuento.</p></li>
<li><p>Use funciones específicas de fecha para obtener el año usando <code>created_ts</code>.</p></li>
<li><p>Asegúrese de definir alias a las columnas como <code>created_year</code> y <code>user_count</code> respectivamente.</p></li>
<li><p>Los datos deben ordenarse de forma ascendente por <code>created_year</code>.</p></li>
<li><p>Cuando ejecutes la consulta usando el entorno <code>Jupyter</code>, puede que tenga decimales para los enteros. Por lo tanto, puede mostrar los resultados incluso con decimales.</p></li>
</ul>
<div id="751c5f22" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT extract(year from created_ts) as created_year, count(user_id) as user_count</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM users</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">            GROUP BY created_year</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">            ORDER BY created_year;</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'created_year'</span><span class="sc">:&lt;15}{</span><span class="st">'user_count'</span><span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> records:</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        created_year, user_count <span class="op">=</span> record</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>created_year<span class="sc">:&lt;15}{</span>user_count<span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Operation done successfully"</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>created_year   user_count     
2018           13             
2019           4              
2020           8              

Operation done successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
<section id="obtenga-los-días-de-nacimiento-de-todos-los-usuarios-nacidos-en-el-mes-may." class="level3">
<h3 class="anchored" data-anchor-id="obtenga-los-días-de-nacimiento-de-todos-los-usuarios-nacidos-en-el-mes-may.">Obtenga los días de nacimiento de todos los usuarios nacidos en el mes <code>May</code>.</h3>
<ul>
<li><p>Utilice la tabla <code>users</code> para este ejercicio.</p></li>
<li><p>La salida debe contener <code>user_id</code>, <code>user_dob</code>, <code>user_email_id</code> y <code>user_day_of_birth</code>.</p></li>
<li><p>Utilice funciones específicas de fecha para obtener el mes utilizando <code>user_dob</code>.</p></li>
<li><p><code>user_day_of_birth</code> debe ser un día completo con el primer carácter en mayúsculas, por ejemplo <code>Tuesday</code>.</p></li>
<li><p>Los datos deben ordenarse por día dentro del mes <code>May</code>.</p></li>
</ul>
<div id="5f2d1533" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT user_id, user_dob, user_email_id, to_char(user_dob, 'Day') AS user_day_of_birth</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM users</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="st">            WHERE extract(month from user_dob) = 5</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="st">            ORDER BY extract(day from user_dob);</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'user_id'</span><span class="sc">:&lt;15}{</span><span class="st">'user_dob'</span><span class="sc">:&lt;15}{</span><span class="st">'user_email_id'</span><span class="sc">:&lt;40}{</span><span class="st">'user_day_of_birth'</span><span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> records:</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        user_id, user_dob, user_email_id, user_day_of_birth <span class="op">=</span> record</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>user_id<span class="sc">:&lt;15}{</span>user_dob<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)<span class="sc">:&lt;15}{</span>user_email_id<span class="sc">:&lt;40}{</span>user_day_of_birth<span class="sc">:&lt;30}</span><span class="ss">"</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Operation done successfully"</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>user_id        user_dob       user_email_id                           user_day_of_birth
4              1998-05-24     mtanswill3@dedecms.com                  Sunday                        
12             1983-05-26     uglayzerb@pinterest.com                 Thursday                      
1              1973-05-31     gbode0@imgur.com                        Thursday                      
2              2003-05-31     lgisbey1@mail.ru                        Saturday                      

Operation done successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
<section id="obtenga-los-nombres-e-ids-de-correo-electrónico-de-los-usuarios-añadidos-en-el-año-2019." class="level3">
<h3 class="anchored" data-anchor-id="obtenga-los-nombres-e-ids-de-correo-electrónico-de-los-usuarios-añadidos-en-el-año-2019.">Obtenga los nombres e ids de correo electrónico de los usuarios añadidos en el año 2019.</h3>
<ul>
<li><p>Utilice la tabla <code>users</code> para este ejercicio.</p></li>
<li><p>La salida debe contener <code>user_id</code>, <code>user_name</code>, <code>user_email_id</code>, <code>created_ts</code>, <code>created_year</code>.</p></li>
<li><p>Utilice funciones específicas de fecha para obtener el año utilizando <code>created_ts</code>.</p></li>
<li><p><code>user_name</code> es una columna derivada de concatenar <code>user_first_name</code> y <code>user_last_name</code> con un espacio en medio.</p></li>
<li><p><code>user_name</code> debe tener valores en mayúsculas.</p></li>
<li><p>Los datos deben ordenarse en forma ascendente por <code>user_name</code></p></li>
</ul>
<div id="9cda36b0" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT user_id, UPPER(CONCAT(user_first_name, ' ', user_last_name)) AS user_name, user_email_id, created_ts, extract(year from created_ts) as created_year</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM users</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="st">            WHERE extract(year from created_ts) = 2019</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="st">            ORDER BY user_name;</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'user_id'</span><span class="sc">:&lt;15}{</span><span class="st">'user_name'</span><span class="sc">:&lt;40}{</span><span class="st">'user_email_id'</span><span class="sc">:&lt;40}{</span><span class="st">'created_ts'</span><span class="sc">:&lt;30}{</span><span class="st">'created_year'</span><span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> records:</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        user_id, user_name, user_email_id, created_ts, created_year <span class="op">=</span> record</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>user_id<span class="sc">:&lt;15}{</span>user_name<span class="sc">:&lt;40}{</span>user_email_id<span class="sc">:&lt;40}{</span>created_ts<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>)<span class="sc">:&lt;30}{</span>created_year<span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Operation done successfully"</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>user_id        user_name                               user_email_id                           created_ts                    created_year   
8              CYBIL LISSIMORE                         clissimore7@pinterest.com               2019-12-09 14:08:30           2019           
25             PHYLYS ASLIE                            paslieo@qq.com                          2019-10-01 01:34:28           2019           
12             UNA GLAYZER                             uglayzerb@pinterest.com                 2019-09-17 03:24:21           2019           
17             YANKEE JELF                             yjelfg@wufoo.com                        2019-09-16 16:09:12           2019           

Operation done successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
<section id="obtenga-el-número-de-usuarios-por-género.-utilice-la-tabla-de-users-para-este-ejercicio." class="level3">
<h3 class="anchored" data-anchor-id="obtenga-el-número-de-usuarios-por-género.-utilice-la-tabla-de-users-para-este-ejercicio.">Obtenga el número de usuarios por género. Utilice la tabla de <code>users</code> para este ejercicio.</h3>
<ul>
<li><p>La salida debe contener el <code>gender</code> y <code>user_count</code>.</p></li>
<li><p>Para los hombres la salida debe mostrar <code>Male</code> y para las mujeres la salida debe mostrar <code>Female</code>.</p></li>
<li><p>Si no se especifica el sexo, se mostrará <code>Not Specified</code>.</p></li>
<li><p>Los datos deben ordenarse en forma descendente por <code>user_count</code>.</p></li>
</ul>
<div id="2305c1bd" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT </span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="st">                CASE </span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHEN user_gender = 'M' THEN 'Male'</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHEN user_gender = 'F' THEN 'Female'</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="st">                    ELSE 'Not Specified'</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">                END AS gender,</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">                COUNT(user_id) AS user_count</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM users</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">            GROUP BY gender</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="st">            ORDER BY user_count DESC;</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'gender'</span><span class="sc">:&lt;15}{</span><span class="st">'user_count'</span><span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> records:</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        gender, user_count <span class="op">=</span> record</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>gender<span class="sc">:&lt;15}{</span>user_count<span class="sc">:&lt;15}</span><span class="ss">"</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Operation done successfully"</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gender         user_count     
Female         13             
Male           10             
Not Specified  2              

Operation done successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
<section id="obtenga-los-4-últimos-dígitos-de-los-ids-únicos." class="level3">
<h3 class="anchored" data-anchor-id="obtenga-los-4-últimos-dígitos-de-los-ids-únicos.">Obtenga los 4 últimos dígitos de los ids únicos.</h3>
<ul>
<li><p>Utilice la tabla <code>users</code> para este ejercicio.</p></li>
<li><p>El resultado debe contener <code>user_id</code>, <code>user_unique_id</code> y <code>user_unique_id_last4</code>.</p></li>
<li><p>Los identificadores únicos son <code>null</code> o <code>not null</code>.</p></li>
<li><p>Los identificadores únicos contienen números y guiones y son de diferente longitud.</p></li>
<li><p>Necesitamos obtener los últimos 4 dígitos descartando los guiones sólo cuando el número de dígitos es al menos 9.</p></li>
<li><p>Si el identificador único es nulo, debe mostrarse <code>Not Specified</code>.</p></li>
<li><p>Después de descartar los guiones, si el identificador único tiene menos de 9 dígitos, debe mostrar <code>Invalid Unique Id</code>.</p></li>
<li><p>Los datos deben ordenarse por <code>user_id</code>. Es posible que aparezca <code>None</code> o <code>null</code> para aquellos identificadores de usuario en los que no haya un identificador único para <code>user_unique_id</code>.</p></li>
</ul>
<div id="ef70a809" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT </span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="st">                user_id,</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="st">                COALESCE(user_unique_id, 'Not Specified') AS user_unique_id,</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="st">                CASE </span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHEN user_unique_id IS NULL THEN ''</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="st">                    WHEN length(replace(user_unique_id, '-', '')) &lt; 9 THEN 'Invalid Unique Id'</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="st">                    ELSE right(replace(user_unique_id, '-', ''), 4)</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="st">                END AS user_unique_id_last4</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM users</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="st">            ORDER BY user_id;</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'user_id'</span><span class="sc">:&lt;15}{</span><span class="st">'user_unique_id'</span><span class="sc">:&lt;30}{</span><span class="st">'user_unique_id_last4'</span><span class="sc">:&lt;5}</span><span class="ss">"</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> records:</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        user_id, user_unique_id, user_unique_id_last4 <span class="op">=</span> record</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>user_id<span class="sc">:&lt;15}{</span>user_unique_id<span class="sc">:&lt;30}{</span>user_unique_id_last4<span class="sc">:&lt;5}</span><span class="ss">"</span>)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Operation done successfully"</span>)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>user_id        user_unique_id                user_unique_id_last4
1              88833-8759                    8759 
2              262501-029                    1029 
3              391-33-2823                   2823 
4              1195413-80                    1380 
5              471-24-6869                   6869 
6              192374-933                    4933 
7              749-27-47-52                  4752 
8              461-75-4198                   4198 
9              892-36-676-2                  6762 
10             197-54-1646                   1646 
11             232-55-52-58                  5258 
12             898-84-336-6                  3366 
13             247-95-68-44                  6844 
14             415-48-894-3                  8943 
15             403-39-5-869                  5869 
16             399-83-05-03                  0503 
17             607-99-0411                   0411 
18             430-01-578-5                  5785 
19             571-09-6181                   6181 
20             478-32-02-87                  0287 
21             Not Specified                      
22             Not Specified                      
23             830-40-5287                   5287 
24             778-0845                      Invalid Unique Id
25             368-44-4478                   4478 

Operation done successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
<section id="obtenga-el-recuento-de-usuarios-en-función-del-código-de-país." class="level3">
<h3 class="anchored" data-anchor-id="obtenga-el-recuento-de-usuarios-en-función-del-código-de-país.">Obtenga el recuento de usuarios en función del código de país.</h3>
<ul>
<li><p>Utilice la tabla <code>users</code> para este ejercicio.</p></li>
<li><p>La salida debe contener el código de país y el recuento.</p></li>
<li><p>No debe haber ningún <code>+</code> en el código de país. Sólo debe contener dígitos.</p></li>
<li><p>Los datos deben ordenarse como números por código de país.</p></li>
<li><p>Debemos descartar <code>user_phone_no</code> con valores <code>null</code>.</p></li>
</ul>
<div id="8540e481" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT </span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="st">                REGEXP_REPLACE(SUBSTRING(user_phone_no FROM '\+\d+'), '\D', '') AS country_code,</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="st">                count(user_id) as user_count</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM users</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="st">            WHERE user_phone_no IS NOT NULL</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="st">            GROUP BY REGEXP_REPLACE(SUBSTRING(user_phone_no FROM '\+\d+'), '\D', '')</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="st">            ORDER BY REGEXP_REPLACE(SUBSTRING(user_phone_no FROM '\+\d+'), '\D', '')::integer;</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'country_code'</span><span class="sc">:&lt;15}{</span><span class="st">'user_count'</span><span class="sc">:&lt;30}</span><span class="ss">"</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> record <span class="kw">in</span> records:</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        country_code, user_count <span class="op">=</span> record</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>country_code<span class="sc">:&lt;15}{</span>user_count<span class="sc">:&lt;30}</span><span class="ss">"</span>)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Operation done successfully"</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>country_code   user_count                    
1              1                             
7              2                             
48             1                             
54             1                             
55             1                             
62             3                             
63             1                             
81             1                             
84             1                             
86             4                             
229            1                             
249            1                             
351            1                             
370            1                             
380            1                             
420            1                             
598            1                             

Operation done successfully
PostgreSQL connection is closed</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="tabla-cardano-usd" class="level1">
<h1>Tabla Cardano USD</h1>
<section id="importar-los-datos-del-precio-de-cardano-usd-ada-usd" class="level2">
<h2 class="anchored" data-anchor-id="importar-los-datos-del-precio-de-cardano-usd-ada-usd">Importar los datos del precio de <code>Cardano USD (ADA-USD)</code></h2>
<p>Importe los datos del precio de <code>Cardano USD (ADA-USD)</code> en su instancia de base de datos Docker. En el siguiente link encontrará el <code>CSV</code> de <code>Cardano</code>: <a href="https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/ADA-USD.csv">Cardano USD (ADA-USD)</a>.</p>
<div id="5b465534" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/ADA-USD.csv'</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Open</th>
<th data-quarto-table-cell-role="th">High</th>
<th data-quarto-table-cell-role="th">Low</th>
<th data-quarto-table-cell-role="th">Close</th>
<th data-quarto-table-cell-role="th">Adj Close</th>
<th data-quarto-table-cell-role="th">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2017-10-01</td>
<td>0.021678</td>
<td>0.032226</td>
<td>0.017354</td>
<td>0.024969</td>
<td>0.024969</td>
<td>50068700.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017-10-02</td>
<td>0.024607</td>
<td>0.030088</td>
<td>0.019969</td>
<td>0.025932</td>
<td>0.025932</td>
<td>57641300.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2017-10-03</td>
<td>0.025757</td>
<td>0.027425</td>
<td>0.020690</td>
<td>0.020816</td>
<td>0.020816</td>
<td>16997800.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2017-10-04</td>
<td>0.020864</td>
<td>0.022806</td>
<td>0.020864</td>
<td>0.021931</td>
<td>0.021931</td>
<td>9000050.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2017-10-05</td>
<td>0.021951</td>
<td>0.022154</td>
<td>0.020859</td>
<td>0.021489</td>
<td>0.021489</td>
<td>5562510.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="e48e635d" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(<span class="st">"DROP TABLE IF EXISTS cardano_usd"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="st">            CREATE TABLE cardano_usd(</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="st">                id SERIAL PRIMARY KEY,</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="st">                Date_ DATE,</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="st">                Open NUMERIC,</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="st">                High NUMERIC,</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="st">                Low NUMERIC,</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="st">                Close NUMERIC,</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="st">                Adj_Close NUMERIC,</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="st">                Volume NUMERIC</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="st">            );</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Table created successfully in PostgreSQL"</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Table created successfully in PostgreSQL
PostgreSQL connection is closed</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/create_cardano.png" class="img-fluid figure-img"></p>
<figcaption>Crear tabla cardano_usd</figcaption>
</figure>
</div>
<div id="f59819de" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> <span class="st">"INSERT INTO cardano_usd(Date_, Open, High, Low, Close, Adj_Close, Volume) VALUES (</span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">)"</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> df.to_records(index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    cursor.executemany(query, values)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    connection.commit()</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(cursor.rowcount, <span class="st">"records inserted."</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1475 records inserted.
PostgreSQL connection is closed</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/select_cardano.png" class="img-fluid figure-img"></p>
<figcaption>Insertar datos en la tabla de cardano_usd</figcaption>
</figure>
</div>
</section>
<section id="dibuje-un-gráfico-de-candlestick-para-la-criptomoneda" class="level2">
<h2 class="anchored" data-anchor-id="dibuje-un-gráfico-de-candlestick-para-la-criptomoneda">Dibuje un gráfico de <code>candlestick</code> para la criptomoneda</h2>
<p>Para realizar este gráfico, debemos inicialmente obtener la información de la base de datos y guardarla en un <code>DataFrame</code>.</p>
<div id="290b22e5" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    connection <span class="op">=</span> psy.<span class="ex">connect</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        user<span class="op">=</span><span class="st">"myname_user"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        password<span class="op">=</span><span class="st">"password"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        host<span class="op">=</span><span class="st">"localhost"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        port<span class="op">=</span><span class="st">"5432"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        database<span class="op">=</span><span class="st">"myname_db"</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    cursor <span class="op">=</span> connection.cursor()</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    cursor.execute(</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="st">            SELECT *</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM cardano_usd;</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    records <span class="op">=</span> cursor.fetchall()</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    records_data <span class="op">=</span> pd.DataFrame(records)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> []</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> column <span class="kw">in</span> cursor.description:</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        columns.append(column[<span class="dv">0</span>])</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    records_data.columns <span class="op">=</span> columns</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    records_data <span class="op">=</span> records_data.drop(columns<span class="op">=</span>[<span class="st">'id'</span>])</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    columns.remove(<span class="st">'id'</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    display(records_data.head())</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> (<span class="pp">Exception</span>, Error) <span class="im">as</span> error:</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Error while connecting to PostgreSQL"</span>, error)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connection):</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>        cursor.close()</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>        connection.close()</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"PostgreSQL connection is closed"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date_</th>
<th data-quarto-table-cell-role="th">open</th>
<th data-quarto-table-cell-role="th">high</th>
<th data-quarto-table-cell-role="th">low</th>
<th data-quarto-table-cell-role="th">close</th>
<th data-quarto-table-cell-role="th">adj_close</th>
<th data-quarto-table-cell-role="th">volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2017-10-01</td>
<td>0.021678</td>
<td>0.032226</td>
<td>0.017354</td>
<td>0.024969</td>
<td>0.024969</td>
<td>50068700.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017-10-02</td>
<td>0.024607</td>
<td>0.030088</td>
<td>0.019969</td>
<td>0.025932</td>
<td>0.025932</td>
<td>57641300.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2017-10-03</td>
<td>0.025757</td>
<td>0.027425</td>
<td>0.02069</td>
<td>0.020816</td>
<td>0.020816</td>
<td>16997800.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2017-10-04</td>
<td>0.020864</td>
<td>0.022806</td>
<td>0.020864</td>
<td>0.021931</td>
<td>0.021931</td>
<td>9000050.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2017-10-05</td>
<td>0.021951</td>
<td>0.022154</td>
<td>0.020859</td>
<td>0.021489</td>
<td>0.021489</td>
<td>5562510.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>PostgreSQL connection is closed</code></pre>
</div>
</div>
<p>Ahora, para realizar la gráfica, usaremos la librería de <code>plotly</code>.</p>
<div id="04319ca9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>[</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        go.Candlestick(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> records_data[<span class="st">'date_'</span>],</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">open</span> <span class="op">=</span> records_data[<span class="st">'open'</span>],</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>            high <span class="op">=</span> records_data[<span class="st">'high'</span>],</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>            low <span class="op">=</span> records_data[<span class="st">'low'</span>],</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>            close <span class="op">=</span> records_data[<span class="st">'close'</span>]</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">'Cardano USD (ADA-USD)'</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    xaxis_title <span class="op">=</span> <span class="st">'Date'</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    yaxis_title <span class="op">=</span> <span class="st">'Price (USD)'</span>,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    font<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        family<span class="op">=</span><span class="st">"Courier New, monospace"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">14</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"silver"</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    plot_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    paper_bgcolor<span class="op">=</span><span class="st">'rgba(0, 0, 0, 0.0)'</span>,</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    xaxis<span class="op">=</span>{<span class="st">'gridcolor'</span>: <span class="st">'#111'</span>},</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span>{<span class="st">'gridcolor'</span>: <span class="st">'#111'</span>},</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>fig.update_layout(xaxis_rangeslider_visible<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>                            <div id="205a55f7-8ef8-4e00-aaa3-5f90462296b3" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("205a55f7-8ef8-4e00-aaa3-5f90462296b3")) {                    Plotly.newPlot(                        "205a55f7-8ef8-4e00-aaa3-5f90462296b3",                        [{"close":[0.024969,0.025932,0.020816,0.021931,0.021489,0.018539,0.020941,0.020477,0.022114,0.021531,0.02252,0.026252,0.033641,0.032465,0.030049,0.028948,0.027217,0.026691,0.027032,0.03063,0.028436,0.027729,0.025454,0.027193,0.027527,0.027132,0.026382,0.025866,0.028607,0.028583,0.030437,0.022986,0.021306,0.022628,0.022022,0.020635,0.021881,0.022195,0.025186,0.032053,0.027119,0.027437,0.023977,0.025808,0.02623,0.026445,0.02758,0.025773,0.026369,0.028084,0.029581,0.02833,0.028549,0.027444,0.028382,0.030447,0.036332,0.050593,0.119744,0.089718,0.119883,0.131352,0.132351,0.131807,0.13587,0.127488,0.117839,0.105501,0.115465,0.119609,0.110281,0.121383,0.133891,0.134281,0.240753,0.213467,0.404665,0.513011,0.518198,0.531273,0.486151,0.477851,0.40715,0.414027,0.390029,0.416363,0.428465,0.414176,0.407701,0.529299,0.639243,0.719695,0.728657,0.782587,1.07966,1.11412,0.999559,1.02715,1.00852,0.899002,0.814743,0.793121,0.688412,0.897508,0.884124,0.802262,0.778587,0.626493,0.629102,0.659843,0.650498,0.70751,0.613163,0.570458,0.56307,0.622208,0.637495,0.623382,0.616833,0.670286,0.623204,0.531913,0.519315,0.421672,0.390534,0.438836,0.379303,0.327371,0.369753,0.340447,0.356584,0.391602,0.405872,0.369769,0.384315,0.373314,0.396908,0.409368,0.40381,0.419883,0.385618,0.391472,0.378779,0.364441,0.337871,0.345258,0.322966,0.344033,0.338335,0.335536,0.312581,0.304397,0.293504,0.297106,0.300787,0.297622,0.285357,0.247281,0.221743,0.222207,0.209873,0.223498,0.223722,0.223026,0.199562,0.185709,0.178878,0.154763,0.156155,0.197648,0.204947,0.213189,0.203481,0.189259,0.189201,0.184605,0.167806,0.154926,0.160058,0.146882,0.147209,0.155919,0.150768,0.156385,0.172447,0.155356,0.148758,0.144451,0.148794,0.156599,0.153106,0.156347,0.166029,0.212233,0.200532,0.200853,0.22139,0.256646,0.243724,0.260341,0.272358,0.301247,0.29058,0.285535,0.288473,0.312875,0.271654,0.294295,0.288489,0.357874,0.365057,0.343318,0.358693,0.37242,0.369709,0.360182,0.366338,0.350021,0.335176,0.328352,0.323593,0.297089,0.260127,0.270932,0.28589,0.273434,0.260155,0.256375,0.243664,0.245544,0.243271,0.256136,0.24884,0.224408,0.202873,0.208989,0.200655,0.196567,0.193557,0.174783,0.20319,0.211143,0.225214,0.222507,0.227742,0.228154,0.214012,0.220467,0.215721,0.211119,0.205358,0.202091,0.176868,0.18128,0.166585,0.160408,0.172375,0.162747,0.162962,0.16138,0.164117,0.167185,0.161985,0.158556,0.139839,0.137868,0.132703,0.135269,0.126099,0.127444,0.11932,0.12572,0.137671,0.142208,0.158278,0.150655,0.15096,0.148921,0.146084,0.150373,0.145389,0.139971,0.128792,0.131483,0.127181,0.137887,0.137092,0.142262,0.156118,0.170865,0.179378,0.180869,0.162175,0.163637,0.170277,0.164028,0.173172,0.172731,0.164765,0.16554,0.16338,0.163313,0.154087,0.143297,0.140901,0.131941,0.130255,0.127547,0.131721,0.130553,0.125378,0.113752,0.123507,0.116355,0.112439,0.11297,0.10291,0.094662,0.09504,0.095331,0.109887,0.099785,0.102437,0.093764,0.095003,0.090149,0.092453,0.094077,0.094282,0.093338,0.100264,0.10548,0.105469,0.10056,0.102196,0.106827,0.104432,0.103607,0.105265,0.087569,0.088666,0.083983,0.078235,0.076643,0.073508,0.070513,0.066745,0.069829,0.068248,0.069322,0.069963,0.063899,0.06943,0.07235,0.081493,0.087606,0.083193,0.089754,0.082754,0.081028,0.079476,0.086001,0.084032,0.084606,0.085195,0.084469,0.082525,0.080789,0.081304,0.082991,0.081303,0.084658,0.086607,0.086357,0.084679,0.070939,0.073214,0.073103,0.071293,0.074789,0.075814,0.077408,0.075131,0.075836,0.076342,0.075873,0.075776,0.074743,0.074321,0.073859,0.073713,0.072886,0.073166,0.069627,0.069647,0.069705,0.070867,0.072584,0.071479,0.076229,0.076148,0.080952,0.078544,0.076493,0.074226,0.075221,0.076481,0.076001,0.073603,0.064824,0.063543,0.061151,0.060675,0.061916,0.052582,0.044777,0.04778,0.044255,0.043412,0.038458,0.037725,0.035806,0.036461,0.042021,0.041866,0.038916,0.041468,0.041672,0.038671,0.037699,0.034251,0.030798,0.029864,0.030678,0.031693,0.030203,0.029551,0.030609,0.02919,0.028358,0.028274,0.029103,0.032824,0.034735,0.034545,0.039401,0.040796,0.042009,0.04423,0.045716,0.041511,0.041198,0.036944,0.041862,0.041508,0.04328,0.041063,0.042547,0.045258,0.042682,0.043812,0.044701,0.049261,0.047996,0.048525,0.052169,0.044529,0.044147,0.043704,0.040241,0.044059,0.04281,0.044777,0.045318,0.044316,0.04575,0.043477,0.042937,0.043578,0.0429,0.043027,0.042691,0.042649,0.041168,0.038772,0.038251,0.039656,0.038374,0.038678,0.039317,0.038029,0.037857,0.037896,0.036663,0.036396,0.040751,0.041058,0.04283,0.041733,0.041751,0.041118,0.04054,0.0406,0.041026,0.041452,0.045605,0.046158,0.047551,0.044969,0.046163,0.048593,0.042456,0.044043,0.043304,0.04327,0.043123,0.043279,0.042838,0.042312,0.040602,0.043212,0.042843,0.042944,0.042664,0.046728,0.045698,0.047633,0.047397,0.04659,0.048055,0.050077,0.051621,0.050207,0.050452,0.052594,0.053891,0.0529,0.058062,0.063781,0.061704,0.059025,0.06237,0.067595,0.065828,0.071289,0.071739,0.069746,0.07233,0.085467,0.090723,0.08737,0.091226,0.090289,0.090484,0.087009,0.083749,0.089964,0.083385,0.083463,0.083731,0.084643,0.082307,0.083783,0.083074,0.081775,0.0795,0.076506,0.074106,0.07804,0.074524,0.072645,0.069244,0.069219,0.070196,0.068591,0.064631,0.070346,0.069014,0.068579,0.069858,0.06688,0.066146,0.06678,0.064036,0.064606,0.061691,0.063428,0.075171,0.070086,0.073072,0.084505,0.093951,0.088161,0.08326,0.079104,0.086996,0.084848,0.084617,0.077955,0.08069,0.080869,0.080502,0.086014,0.091695,0.092815,0.090867,0.08451,0.089441,0.090533,0.096578,0.088708,0.082486,0.083438,0.083472,0.085807,0.084213,0.07947,0.085537,0.087965,0.096525,0.089739,0.090619,0.091683,0.092321,0.093557,0.089148,0.089979,0.087385,0.089562,0.094367,0.096644,0.097719,0.096357,0.09682,0.086449,0.089295,0.090422,0.082098,0.083822,0.081077,0.082998,0.077774,0.076532,0.077335,0.079964,0.080476,0.077993,0.07194,0.065199,0.069754,0.06677,0.059429,0.059537,0.052052,0.055239,0.058772,0.059787,0.062958,0.061203,0.059466,0.055812,0.059046,0.058664,0.062884,0.059871,0.059474,0.060393,0.059944,0.060152,0.058872,0.057412,0.057763,0.056271,0.05668,0.053369,0.051906,0.05197,0.047641,0.051981,0.054981,0.052938,0.052561,0.047,0.047519,0.046841,0.047393,0.050731,0.050298,0.049195,0.047113,0.04941,0.04979,0.050177,0.049439,0.049697,0.049839,0.045825,0.044697,0.044825,0.04499,0.044543,0.045362,0.046771,0.045517,0.044437,0.044415,0.046198,0.046719,0.046931,0.04651,0.04499,0.045452,0.045753,0.046524,0.046799,0.047071,0.049008,0.053292,0.052504,0.05234,0.051922,0.049111,0.046264,0.037573,0.039396,0.038229,0.039532,0.038827,0.037486,0.038885,0.038507,0.039445,0.038361,0.039667,0.03973,0.039324,0.041672,0.041441,0.042629,0.041661,0.040623,0.040542,0.041325,0.041789,0.039766,0.038741,0.039524,0.038073,0.039225,0.039529,0.03928,0.038816,0.036409,0.037685,0.041246,0.040547,0.042335,0.042363,0.043444,0.041967,0.041636,0.042345,0.042599,0.04193,0.043236,0.044328,0.044956,0.043637,0.042297,0.042445,0.043958,0.043194,0.043767,0.043492,0.043119,0.043974,0.044172,0.045421,0.043802,0.042542,0.041178,0.038406,0.037148,0.038343,0.035588,0.036048,0.036993,0.039049,0.03919,0.041423,0.040425,0.039587,0.038056,0.037917,0.037405,0.037871,0.038317,0.038757,0.038948,0.037483,0.036606,0.036655,0.036723,0.037108,0.036427,0.036653,0.034269,0.0318,0.034462,0.033251,0.034004,0.033262,0.034466,0.0332,0.034162,0.033728,0.034281,0.0331,0.033632,0.034284,0.033594,0.032845,0.033458,0.032751,0.03418,0.034595,0.034721,0.037272,0.037047,0.036435,0.036359,0.036874,0.036825,0.03769,0.036966,0.04166,0.042553,0.041391,0.044978,0.044851,0.041979,0.043873,0.045989,0.045654,0.043334,0.045004,0.043248,0.044581,0.047912,0.052857,0.053514,0.05607,0.053793,0.056092,0.055768,0.056979,0.055996,0.059231,0.059757,0.05979,0.059944,0.061809,0.060394,0.063228,0.068373,0.068581,0.07058,0.063863,0.062654,0.060042,0.062597,0.057645,0.05826,0.05864,0.058336,0.06151,0.05896,0.056364,0.049453,0.049685,0.048616,0.047541,0.045932,0.048953,0.048761,0.049004,0.051057,0.051448,0.048945,0.043291,0.041482,0.041495,0.039649,0.023961,0.028437,0.026009,0.02712,0.024121,0.025243,0.025336,0.030451,0.029368,0.029414,0.027089,0.029082,0.030163,0.029438,0.030727,0.029301,0.029771,0.028249,0.029873,0.030553,0.030855,0.031984,0.032295,0.032505,0.032003,0.035616,0.035137,0.036314,0.036198,0.033215,0.033354,0.033806,0.033107,0.032974,0.031863,0.034408,null,0.036553,0.035816,0.034177,0.0347,0.036559,0.040605,0.041868,0.042408,0.045879,0.046601,0.047195,0.051695,0.047846,0.05126,0.051014,0.048929,0.049664,0.049358,0.049767,0.051106,0.052303,0.051736,0.047677,0.048108,0.050421,0.051472,0.05089,0.050463,0.050932,0.051343,0.054252,0.056449,0.056875,0.052246,0.055833,0.055322,0.052641,0.054011,0.05343,0.055183,0.064559,0.06466,0.076958,0.074352,0.081168,0.078456,0.085439,0.089,0.085442,0.086026,0.086654,0.08643,0.083407,0.083531,0.07536,0.079554,0.079028,0.076748,0.078387,0.079073,0.083445,0.082174,0.079603,0.079339,0.078475,0.08361,0.08295,0.082583,0.081691,0.080561,0.077679,0.080392,0.08387,0.083116,0.095954,0.094326,0.096538,0.099952,0.098211,0.105221,0.117554,0.129908,0.124293,0.118316,0.125214,0.126783,0.124156,0.131963,0.130369,0.125922,0.122486,0.122477,0.123712,0.117924,0.122965,0.123922,0.123773,0.121888,0.143578,0.148108,0.138771,0.148598,0.139879,0.140588,0.138798,0.143573,0.133505,0.137335,0.143018,0.142695,0.144048,0.139155,0.145781,0.145244,0.143855,0.137436,0.137398,0.141245,0.138338,0.138303,0.138471,0.14092,0.137427,0.129275,0.133642,0.12376,0.125276,0.121595,0.124488,0.113292,0.115285,0.106824,0.109453,0.116712,0.117437,0.122688,0.125411,0.115613,0.096154,0.102445,0.089923,0.09306,0.093333,0.091011,0.093349,0.097156,0.096989,0.097598,0.094856,0.096769,0.093496,0.09165,0.094217,0.091081,0.091657,0.089433,0.080428,0.081754,0.07683,0.082895,0.096909,0.09555,0.101206,0.100696,0.101136,0.101146,0.097878,0.092913,0.093684,0.096301,0.097687,0.092909,0.093936,0.096242,null,0.105025,0.106538,null,null,0.107297,0.106635,0.104064,0.106104,0.107388,0.108677,0.102494,0.106187,0.110572,0.108083,0.108075,0.106351,0.103097,0.102827,0.098977,0.095376,0.093369,0.093056,0.098197,0.092143,0.093434,0.095369,0.096994,0.109105,0.101379,0.106621,0.105325,0.105805,0.105965,0.104525,0.106391,0.104202,0.100531,0.104008,0.1096,0.106403,0.105866,0.118226,0.132945,0.14476,0.15351,0.166323,0.155162,0.138281,0.141028,0.164791,0.166639,0.171308,0.155983,0.158557,0.164212,0.148241,0.159668,0.158867,0.15413,0.140928,0.148165,0.141994,0.139449,0.14446,0.153964,0.157992,0.154305,0.167589,0.163483,0.164988,0.164714,0.161988,0.152656,0.156179,0.136394,0.152883,0.157564,0.157824,0.154422,0.176735,0.192164,0.18404,0.181397,0.17535,0.177423,0.204995,0.224762,0.258314,0.331898,0.29998,0.305597,0.332973,0.304895,0.275466,0.287003,0.313609,0.310396,0.30253,0.352444,0.379852,0.371428,0.369137,0.375394,0.310209,0.349577,0.345643,0.353881,0.343886,0.344234,0.31308,0.333303,0.348131,0.362619,0.344898,0.402033,0.426247,0.4414,0.441051,0.537874,0.627886,0.663238,0.682511,0.703516,0.930318,0.927741,0.925587,0.905719,0.848419,0.861012,0.870951,0.89092,0.914119,0.927649,1.122958,1.10052,1.099151,0.954709,1.051657,1.079116,1.241105,1.32486,1.308059,1.292388,1.225582,1.216593,1.114868,1.168523,1.131012,1.133367,1.118053,1.195161,1.135003,1.12479,1.039144,1.103314,1.059154,1.033539,1.242953,1.378673,1.239006,1.30217,1.206541,1.18914,1.109874,1.121552,1.075002,1.101574,1.213969,1.176577,1.191124,1.202541,1.213317,1.193264,1.189244,1.196509,1.173277,1.19142,1.2143,1.255354,1.175149,1.219436,1.20354,1.218758,1.266735,1.316127,1.411786,1.45542,1.481588,1.416949,1.384869,1.275501,1.197959,1.265934,1.206735,1.147017,1.155702,1.101355,1.08825,1.234019,1.306927,1.335666,1.308014,1.352449,1.353071,1.326812,1.36203,1.274111,1.475529,1.650124,1.653453,1.619554,1.770562,1.644696,1.764077,1.552775,1.933668,2.004796,2.174027,2.309113,2.032226,2.003662,1.482521,1.810469,1.552277,1.463622,1.325436,1.549485,1.555369,1.782702,1.64596,1.511987,1.406232,1.577279,1.742778,1.734753,1.752824,1.840471,1.710908,1.659009,1.678248,1.564106,1.58803,1.624826,1.531857,1.436378,1.48022,1.558359,1.57511,1.597756,1.482573,1.482194,1.415396,1.39057,1.429188,1.17748,1.153254,1.252896,1.356087,1.256478,1.25044,1.335202,1.324752,1.368437,1.383472,1.335611,1.394397,1.406836,1.458184,1.404898,1.418053,1.403118,1.330146,1.349474,1.336085,1.348145,1.315099,1.265083,1.262258,1.223192,1.173715,1.172302,1.183698,1.121116,1.056291,1.168098,1.186161,1.206307,1.233497,1.228501,1.258493,1.278446,1.283504,1.284084,1.308952,1.322345,1.31773,1.310068,1.365026,1.376564,1.386145,1.401786,1.470677,1.42783,1.47764,1.672566,1.798038,1.823878,2.136079,2.191687,2.169153,2.079417,1.926601,2.10856,2.42814,2.457702,2.435435,2.713725,2.917386,2.721091,2.738132,2.535528,2.944197,2.84749,2.855986,2.73316,2.772475,2.870767,2.963438,2.968239,2.832807,2.910824,2.831897,2.502491,2.474989,2.517666,2.385911,2.63395,2.581727,2.400663,2.395638,2.501635,2.420969,2.346419,2.369978,2.282299,2.063989,1.987028,2.266182,2.330941,2.281269,2.301541,2.208495,2.135905,2.039139,2.065688,2.114452,2.258127,2.251459,2.252873,2.189235,2.233124,2.212155,2.276995,2.237176,2.266615,2.197214,2.173389,2.11919,2.189053,2.179529],"high":[0.032226,0.030088,0.027425,0.022806,0.022154,0.021542,0.02105,0.023598,0.022807,0.022446,0.022576,0.026763,0.033816,0.038268,0.033641,0.030749,0.029628,0.02736,0.027112,0.030855,0.030806,0.028744,0.028051,0.028956,0.027846,0.02756,0.027463,0.026853,0.029837,0.028874,0.030715,0.029219,0.024977,0.023213,0.023849,0.023006,0.023609,0.023347,0.026393,0.03506,0.033348,0.029659,0.027952,0.0263,0.026788,0.027773,0.02817,0.027436,0.027122,0.028478,0.0323,0.029709,0.029034,0.028678,0.028597,0.030447,0.039855,0.057127,0.13173,0.146906,0.128303,0.131352,0.138869,0.13922,0.145946,0.136404,0.132855,0.124176,0.120726,0.13866,0.119794,0.121383,0.138008,0.141854,0.240753,0.233209,0.447192,0.592417,0.526496,0.589589,0.533705,0.523619,0.478974,0.450368,0.416661,0.4397,0.430086,0.430827,0.418934,0.556879,0.777385,0.754446,0.730051,0.794646,1.08567,1.32721,1.25242,1.05401,1.04396,0.999329,0.919436,0.816252,0.791522,0.932269,0.969325,0.881961,0.884506,0.780621,0.678517,0.711008,0.68852,0.726242,0.706391,0.631485,0.592231,0.636009,0.683023,0.652848,0.632956,0.681946,0.669373,0.624799,0.550252,0.535322,0.41946,0.501639,0.48014,0.399523,0.378719,0.377219,0.367504,0.394133,0.462766,0.405196,0.393307,0.387018,0.401321,0.416687,0.412404,0.428074,0.42001,0.396608,0.404329,0.383513,0.372116,0.35124,0.352488,0.354572,0.346955,0.341189,0.336163,0.311973,0.307058,0.309129,0.303588,0.317723,0.303019,0.287598,0.254354,0.225115,0.226558,0.227322,0.237342,0.229146,0.233147,0.201611,0.186788,0.17916,0.161959,0.197648,0.212004,0.227502,0.221969,0.202812,0.20119,0.189128,0.185421,0.169225,0.165599,0.160614,0.151782,0.160559,0.160825,0.158797,0.173438,0.179172,0.156204,0.150481,0.151469,0.158452,0.165656,0.15782,0.166431,0.214525,0.218382,0.206495,0.223444,0.256646,0.272641,0.262368,0.273836,0.301641,0.307552,0.296879,0.289623,0.318699,0.312805,0.294972,0.307469,0.364954,0.387901,0.364297,0.363261,0.376704,0.389749,0.370777,0.373605,0.365933,0.349948,0.348219,0.328426,0.327908,0.299462,0.28341,0.290151,0.286088,0.27876,0.260186,0.263111,0.246809,0.248354,0.260785,0.261169,0.250076,0.22615,0.213302,0.210636,0.205492,0.196436,0.194977,0.208739,0.218023,0.230057,0.229184,0.229531,0.236761,0.231228,0.221728,0.220862,0.219351,0.210841,0.209668,0.201517,0.181937,0.182888,0.166818,0.176521,0.172218,0.164628,0.164477,0.167511,0.169903,0.167331,0.163757,0.159019,0.143279,0.138592,0.138254,0.136055,0.128,0.128503,0.127436,0.138372,0.145731,0.161936,0.166687,0.159904,0.154572,0.148749,0.150373,0.151385,0.146111,0.140654,0.133925,0.13156,0.141729,0.139891,0.145511,0.156755,0.174619,0.19293,0.189499,0.18265,0.168841,0.177814,0.179393,0.176757,0.175304,0.17474,0.168709,0.166228,0.164772,0.163234,0.154187,0.145038,0.142481,0.134835,0.134591,0.13203,0.136404,0.1331,0.125594,0.127082,0.124966,0.116669,0.114788,0.115714,0.102779,0.101081,0.098572,0.109917,0.112477,0.104358,0.103728,0.096051,0.100128,0.093339,0.094363,0.095007,0.094625,0.100795,0.106655,0.108924,0.107144,0.102756,0.108901,0.107182,0.105193,0.106509,0.106217,0.089429,0.089645,0.08513,0.081148,0.078133,0.07475,0.070794,0.070931,0.070719,0.070365,0.069981,0.07027,0.07022,0.074414,0.082661,0.089908,0.08839,0.093225,0.091354,0.082303,0.082871,0.087636,0.088327,0.086371,0.086804,0.085806,0.084681,0.082405,0.082789,0.083091,0.083729,0.085151,0.088169,0.087511,0.086432,0.084552,0.07588,0.07489,0.073775,0.078624,0.076625,0.078271,0.077955,0.076463,0.077146,0.077536,0.07651,0.076139,0.075652,0.074345,0.07396,0.073792,0.073296,0.073215,0.070024,0.069829,0.071464,0.07304,0.072621,0.077307,0.07888,0.080952,0.08131,0.079424,0.077429,0.075992,0.077373,0.077216,0.075965,0.073441,0.065245,0.064053,0.061062,0.062933,0.061903,0.052732,0.04823,0.048532,0.044662,0.044301,0.038836,0.039378,0.036982,0.044108,0.044518,0.042309,0.042521,0.043286,0.041884,0.039842,0.037714,0.035501,0.030797,0.031807,0.032515,0.032068,0.030434,0.031115,0.030722,0.029557,0.028568,0.029697,0.03385,0.034912,0.038265,0.039886,0.04551,0.042156,0.044855,0.049282,0.045675,0.043035,0.04169,0.042634,0.04394,0.043665,0.043364,0.042547,0.045563,0.045259,0.044092,0.04557,0.049637,0.050744,0.050021,0.05274,0.054636,0.045157,0.04463,0.043812,0.044484,0.044385,0.045247,0.046222,0.045308,0.046441,0.045981,0.043671,0.04408,0.044112,0.043487,0.043248,0.043539,0.04268,0.041318,0.03942,0.040075,0.040287,0.039136,0.039317,0.039411,0.038595,0.038347,0.037993,0.037182,0.041207,0.04199,0.042994,0.042772,0.041991,0.04231,0.041355,0.041366,0.041254,0.041844,0.04669,0.048026,0.047665,0.047779,0.046163,0.048885,0.05046,0.044568,0.044019,0.043822,0.043725,0.044113,0.043532,0.042996,0.042477,0.043353,0.04347,0.043581,0.043794,0.046951,0.046754,0.048525,0.048216,0.048584,0.048252,0.050829,0.051876,0.051762,0.051134,0.053691,0.053923,0.054958,0.059172,0.064727,0.064347,0.06185,0.06237,0.068331,0.067593,0.072777,0.073712,0.072125,0.072756,0.085467,0.099958,0.094088,0.092228,0.093681,0.091286,0.091622,0.087018,0.092479,0.090716,0.085376,0.085507,0.085479,0.085634,0.08386,0.08456,0.083883,0.081782,0.079515,0.077978,0.079376,0.080333,0.07584,0.07603,0.070828,0.071602,0.070646,0.06897,0.070346,0.07077,0.06971,0.071937,0.071954,0.067966,0.068471,0.068643,0.06499,0.065069,0.064837,0.078432,0.076754,0.076612,0.084571,0.094902,0.100402,0.090825,0.084879,0.088229,0.086993,0.086443,0.08546,0.080695,0.083375,0.082559,0.086936,0.093476,0.093248,0.093769,0.096768,0.089937,0.092815,0.097519,0.098342,0.088447,0.085117,0.083979,0.087672,0.086594,0.084278,0.085685,0.089169,0.096554,0.096988,0.091249,0.092738,0.094279,0.093908,0.093698,0.091582,0.090263,0.091294,0.097834,0.102144,0.09907,0.098242,0.10691,0.099549,0.089691,0.091089,0.091168,0.085895,0.084598,0.083792,0.083007,0.078091,0.08029,0.080261,0.082259,0.080821,0.078322,0.072011,0.070841,0.070919,0.067184,0.0603,0.060983,0.057911,0.059512,0.060806,0.065132,0.064214,0.062067,0.059556,0.059116,0.060573,0.062913,0.063677,0.06,0.061975,0.06118,0.060914,0.060288,0.058936,0.058365,0.058185,0.058363,0.056678,0.054075,0.052933,0.052058,0.053137,0.055928,0.054796,0.053012,0.053496,0.048017,0.047536,0.048045,0.051209,0.050813,0.050331,0.049226,0.051161,0.050267,0.051191,0.052605,0.050944,0.04995,0.050333,0.045835,0.045856,0.045585,0.045357,0.046113,0.047399,0.046789,0.045543,0.044763,0.046585,0.047653,0.047211,0.04814,0.046639,0.046414,0.045795,0.047088,0.047114,0.047662,0.050429,0.054921,0.054614,0.052557,0.053348,0.051954,0.049555,0.046666,0.040334,0.040287,0.039924,0.039766,0.038917,0.039287,0.039958,0.039516,0.039728,0.040385,0.039993,0.040323,0.041898,0.04218,0.043313,0.042641,0.042165,0.041236,0.041801,0.042162,0.041948,0.039952,0.039533,0.039594,0.039672,0.039619,0.039559,0.040109,0.038979,0.038109,0.041799,0.043177,0.042985,0.044553,0.043819,0.044337,0.042792,0.042858,0.042745,0.042684,0.043257,0.044928,0.046105,0.045018,0.043837,0.042755,0.044227,0.044122,0.044631,0.044044,0.04355,0.044432,0.044655,0.046423,0.046652,0.044451,0.042794,0.041249,0.038685,0.038423,0.038916,0.037184,0.037074,0.0398,0.03999,0.04204,0.042268,0.040426,0.039769,0.038761,0.038533,0.038979,0.038323,0.039249,0.039241,0.038974,0.037556,0.037326,0.036931,0.037372,0.037527,0.036803,0.036716,0.034285,0.034662,0.034793,0.034009,0.034074,0.034495,0.034584,0.03505,0.034409,0.034768,0.034427,0.034211,0.03469,0.034595,0.033898,0.033813,0.033507,0.034427,0.034685,0.035356,0.037299,0.037807,0.038551,0.036445,0.03698,0.037579,0.037748,0.037944,0.042219,0.042958,0.043091,0.045679,0.045544,0.045765,0.044296,0.046548,0.046335,0.045814,0.045243,0.045185,0.044633,0.048798,0.054328,0.057302,0.05688,0.056567,0.057148,0.05845,0.057712,0.057663,0.059851,0.06058,0.06228,0.061143,0.062215,0.061941,0.063228,0.070173,0.07207,0.070989,0.07114,0.066931,0.06256,0.063038,0.062869,0.058676,0.059914,0.059023,0.061743,0.061698,0.058976,0.05649,0.051919,0.051206,0.049879,0.048167,0.049634,0.049369,0.050268,0.052307,0.051722,0.0517,0.048927,0.043947,0.042956,0.04173,0.039701,0.029228,0.028976,0.028789,0.027111,0.026211,0.025993,0.031715,0.033702,0.030272,0.030256,0.029082,0.030251,0.030441,0.030742,0.03121,0.029977,0.029849,0.030072,0.030636,0.030855,0.033057,0.032715,0.032559,0.032562,0.035617,0.036869,0.036595,0.036597,0.036239,0.034012,0.034668,0.033831,0.033686,0.033695,0.034612,null,0.036821,0.036838,0.036705,0.034995,0.036733,0.041847,0.043843,0.043669,0.046224,0.047672,0.048065,0.051997,0.054257,0.051955,0.05151,0.051691,0.050228,0.050502,0.051128,0.051487,0.053539,0.053028,0.051744,0.04945,0.050933,0.052045,0.051885,0.051767,0.051229,0.052078,0.054827,0.056887,0.057326,0.057482,0.056926,0.056437,0.05605,0.054345,0.05416,0.055914,0.067179,0.066666,0.07725,0.086029,0.082385,0.08245,0.085664,0.090089,0.089163,0.087173,0.088604,0.087013,0.08653,0.083776,0.085147,0.080668,0.079657,0.079173,0.07986,0.079717,0.083661,0.084455,0.082139,0.080443,0.080932,0.08361,0.084018,0.087011,0.083487,0.082007,0.081239,0.081413,0.084336,0.084979,0.096085,0.096897,0.101483,0.100568,0.099965,0.105589,0.118803,0.136554,0.129908,0.124417,0.126715,0.127839,0.134829,0.134267,0.132421,0.132458,0.126491,0.124315,0.124557,0.124031,0.124232,0.124328,0.125859,0.124085,0.144676,0.153705,0.149314,0.15022,0.149396,0.142189,0.14099,0.145829,0.14709,0.13812,0.147619,0.145175,0.145609,0.146949,0.147424,0.152014,0.146591,0.144795,0.138919,0.143157,0.142451,0.140632,0.139167,0.144117,0.143104,0.137965,0.133913,0.133866,0.125744,0.125663,0.12631,0.124592,0.117807,0.116114,0.11077,0.117647,0.118382,0.126408,0.127359,0.126452,0.116423,0.104011,0.103962,0.095189,0.093843,0.096574,0.095745,0.099689,0.097526,0.09871,0.099751,0.098179,0.097932,0.093686,0.094512,0.094217,0.09307,0.09224,0.090285,0.083034,0.082657,0.08356,0.09822,0.099498,0.102269,0.106491,0.103349,0.101345,0.104311,0.099826,0.095158,0.096791,0.098844,0.098548,0.094394,0.096776,null,0.11054,0.108865,null,null,0.112231,0.107591,0.107317,0.106979,0.107601,0.110921,0.108841,0.108286,0.112414,0.111754,0.109662,0.10873,0.107381,0.10549,0.103349,0.100712,0.095587,0.09527,0.098487,0.099935,0.093834,0.096002,0.097573,0.109683,0.113187,0.108298,0.107971,0.108621,0.108403,0.106512,0.107801,0.106841,0.105061,0.104893,0.11197,0.111523,0.107721,0.118231,0.133603,0.152735,0.158153,0.182066,0.174859,0.16022,0.144637,0.171569,0.170575,0.172765,0.173851,0.159662,0.168009,0.164506,0.161383,0.162406,0.159041,0.154936,0.14981,0.14853,0.142694,0.147259,0.156259,0.158002,0.159713,0.167599,0.174342,0.168635,0.170486,0.167724,0.165416,0.160015,0.157414,0.154337,0.166846,0.161981,0.16519,0.178583,0.19617,0.193144,0.185749,0.184246,0.184253,0.208679,0.239661,0.264886,0.346298,0.353344,0.320191,0.338596,0.340394,0.304996,0.31337,0.314465,0.323552,0.329685,0.365411,0.395653,0.395443,0.382987,0.376197,0.378716,0.359159,0.357211,0.368639,0.363512,0.349753,0.344218,0.335361,0.366772,0.37272,0.375405,0.417152,0.452595,0.447355,0.447014,0.556724,0.657628,0.702539,0.719411,0.70904,0.943893,0.973325,0.945056,0.94995,0.914596,0.908158,0.904206,0.895954,0.956904,0.943777,1.193958,1.149899,1.134158,1.133705,1.074832,1.172732,1.290047,1.476653,1.361114,1.342408,1.299627,1.263525,1.229674,1.195125,1.18072,1.142286,1.176217,1.214923,1.204682,1.13825,1.128085,1.182899,1.102982,1.068913,1.258886,1.419344,1.473155,1.342355,1.313273,1.244282,1.20855,1.174177,1.163652,1.152968,1.279076,1.236277,1.219583,1.228019,1.233722,1.213675,1.207719,1.245915,1.244183,1.199748,1.226746,1.340895,1.291087,1.223793,1.22898,1.25192,1.292287,1.346588,1.437677,1.557761,1.494799,1.518984,1.456151,1.397696,1.322387,1.280693,1.286464,1.277444,1.165576,1.196284,1.146124,1.249876,1.329766,1.348198,1.410331,1.369041,1.367415,1.354889,1.37979,1.365681,1.493424,1.699504,1.745329,1.654544,1.829795,1.822609,1.778112,1.818942,1.969934,2.042103,2.371752,2.461766,2.325002,2.150382,2.028092,1.943229,1.86863,1.60102,1.53964,1.597913,1.648563,1.832433,1.790477,1.677707,1.561741,1.688977,1.75062,1.779591,1.803849,1.88865,1.848485,1.783177,1.706524,1.740569,1.594298,1.630414,1.635973,1.546059,1.49353,1.578513,1.592704,1.611401,1.575438,1.538465,1.493233,1.442877,1.460376,1.436257,1.263039,1.305561,1.398589,1.392683,1.291396,1.348168,1.349285,1.419944,1.398117,1.383814,1.394397,1.441714,1.493717,1.461221,1.456887,1.440113,1.406497,1.371523,1.364834,1.366351,1.373091,1.321124,1.287538,1.287742,1.244133,1.193662,1.216031,1.190931,1.134648,1.221106,1.206679,1.207033,1.247973,1.238433,1.399011,1.314803,1.316583,1.299072,1.317354,1.332403,1.386737,1.349569,1.382737,1.392539,1.397315,1.424119,1.484598,1.494273,1.498564,1.699575,1.894406,1.866757,2.145926,2.25036,2.248431,2.19545,2.141046,2.161289,2.449876,2.575276,2.528989,2.718612,2.967398,2.947403,2.795994,2.783461,2.944447,2.948675,2.936252,2.885242,2.877878,2.902614,3.099186,3.029436,2.96639,2.954971,2.92623,2.872511,2.564514,2.621054,2.585671,2.796062,2.783103,2.590281,2.43249,2.578296,2.512983,2.441715,2.435803,2.391871,2.289793,2.224538,2.266182,2.344563,2.344986,2.458108,2.302443,2.271561,2.172157,2.144665,2.134077,2.274002,2.320416,2.307575,2.253159,2.256643,2.250027,2.369656,2.309177,2.297457,2.276212,2.249355,2.173575,2.196761,2.221947],"low":[0.017354,0.019969,0.02069,0.020864,0.020859,0.01836,0.01762,0.020147,0.020342,0.021279,0.020976,0.021825,0.025195,0.029255,0.028694,0.028577,0.025481,0.024637,0.025772,0.026612,0.027977,0.027093,0.024345,0.023766,0.026107,0.026478,0.025674,0.025593,0.025626,0.027586,0.028075,0.022986,0.01821,0.019827,0.02197,0.020635,0.020534,0.021414,0.02166,0.025006,0.026451,0.025684,0.022591,0.023495,0.025342,0.025261,0.025654,0.025184,0.024748,0.025581,0.027612,0.027404,0.027891,0.027444,0.026963,0.027747,0.030118,0.036619,0.047949,0.081436,0.09493,0.113031,0.129132,0.124945,0.12635,0.126777,0.113886,0.105501,0.099136,0.113561,0.100133,0.108638,0.114222,0.122368,0.131843,0.187032,0.204233,0.378013,0.467403,0.501083,0.441621,0.456527,0.293641,0.392567,0.347039,0.362807,0.405608,0.401098,0.367887,0.403945,0.471556,0.642297,0.671941,0.697856,0.778578,1.03765,0.903503,0.929183,0.991391,0.764328,0.796177,0.676835,0.5725,0.659967,0.836486,0.749514,0.777413,0.479944,0.44062,0.591528,0.615936,0.647644,0.590793,0.521889,0.520013,0.544753,0.62156,0.566218,0.595269,0.62056,0.62076,0.523418,0.471337,0.412045,0.274734,0.330815,0.369823,0.319646,0.266523,0.332507,0.336822,0.342911,0.385368,0.363624,0.372595,0.35992,0.370393,0.389937,0.392676,0.401056,0.380787,0.386224,0.377539,0.363394,0.330518,0.322811,0.316064,0.314411,0.32221,0.330971,0.312563,0.288392,0.288875,0.292507,0.286193,0.291055,0.283993,0.236256,0.221131,0.191804,0.208859,0.198153,0.219654,0.215402,0.196005,0.172485,0.175057,0.153132,0.127046,0.156935,0.180294,0.201448,0.192132,0.181424,0.183017,0.1817,0.161128,0.150164,0.154465,0.145712,0.136317,0.144857,0.141343,0.14859,0.155254,0.153626,0.143742,0.14183,0.143829,0.148825,0.147478,0.149316,0.154079,0.16453,0.196567,0.194708,0.19994,0.211808,0.242771,0.242734,0.260818,0.269697,0.272684,0.280765,0.283558,0.287331,0.265164,0.259865,0.287786,0.28713,0.347508,0.336625,0.323701,0.349324,0.368789,0.350842,0.360962,0.341467,0.323506,0.323071,0.304458,0.296317,0.248137,0.241278,0.264361,0.261086,0.257697,0.24372,0.242194,0.234781,0.238934,0.240974,0.247134,0.223408,0.198798,0.193109,0.19732,0.195895,0.192322,0.174002,0.174153,0.201184,0.206205,0.216955,0.219242,0.225118,0.21229,0.204815,0.210708,0.209573,0.202634,0.202091,0.171129,0.167893,0.162788,0.151204,0.155369,0.161929,0.159856,0.161027,0.156708,0.162117,0.156797,0.157551,0.137429,0.134852,0.121962,0.128556,0.126099,0.123925,0.118498,0.114674,0.126036,0.133866,0.138639,0.149461,0.146883,0.145104,0.139473,0.138904,0.144762,0.139948,0.128792,0.126466,0.123154,0.126027,0.133851,0.135277,0.140978,0.150379,0.170299,0.172312,0.161644,0.155729,0.163061,0.164028,0.161279,0.16682,0.162497,0.15666,0.160024,0.160419,0.14928,0.140773,0.13718,0.130469,0.124545,0.125412,0.125517,0.128161,0.124601,0.112637,0.114507,0.113747,0.109195,0.111658,0.102698,0.086951,0.094665,0.093198,0.095172,0.097485,0.09812,0.093618,0.091919,0.088088,0.089165,0.090948,0.09235,0.091405,0.092522,0.100032,0.102186,0.097286,0.099255,0.101877,0.102511,0.102529,0.103385,0.087569,0.08313,0.083456,0.077505,0.075026,0.072209,0.067145,0.061708,0.065717,0.066107,0.067798,0.06662,0.063415,0.062599,0.067413,0.071514,0.08123,0.080326,0.082894,0.082314,0.075378,0.077172,0.078421,0.082045,0.081708,0.083421,0.082636,0.082388,0.079175,0.080534,0.08069,0.080985,0.080741,0.083198,0.084461,0.083542,0.070026,0.069839,0.072471,0.070715,0.069773,0.074392,0.075102,0.07426,0.074427,0.075202,0.075602,0.075145,0.073072,0.07415,0.073163,0.072679,0.072868,0.072361,0.068899,0.069226,0.067883,0.069119,0.070788,0.070822,0.071291,0.074745,0.076337,0.078017,0.076263,0.073912,0.074056,0.074438,0.074949,0.073252,0.0618,0.05825,0.060242,0.059554,0.060803,0.051989,0.042868,0.043027,0.044255,0.041671,0.036933,0.032798,0.034117,0.034029,0.03651,0.039716,0.037721,0.038157,0.04069,0.038027,0.037387,0.034251,0.030798,0.027393,0.028867,0.030227,0.029806,0.028915,0.029305,0.029029,0.027912,0.027791,0.028188,0.029099,0.032167,0.034491,0.034026,0.038632,0.038613,0.041819,0.044286,0.039243,0.039076,0.036548,0.036501,0.04121,0.040842,0.040493,0.040308,0.041982,0.042535,0.042477,0.04335,0.044709,0.047579,0.046749,0.048533,0.042756,0.042749,0.043099,0.039807,0.040204,0.042045,0.042514,0.044024,0.043957,0.043984,0.042552,0.042534,0.041876,0.042695,0.042537,0.042454,0.042533,0.040897,0.037283,0.037044,0.037798,0.037953,0.037117,0.038222,0.037812,0.037796,0.037444,0.03606,0.036332,0.036228,0.040456,0.040007,0.041485,0.040635,0.041048,0.040222,0.040253,0.040569,0.040612,0.04138,0.045656,0.045291,0.04474,0.044838,0.045719,0.042064,0.042168,0.042798,0.042097,0.042948,0.043078,0.04248,0.042158,0.03983,0.040299,0.042354,0.042513,0.042461,0.042656,0.044463,0.044979,0.045893,0.046211,0.046348,0.047956,0.04974,0.050015,0.049668,0.049756,0.051366,0.050767,0.052668,0.057047,0.059715,0.057534,0.059131,0.061273,0.065003,0.065763,0.068405,0.069393,0.069019,0.070908,0.08484,0.083283,0.087342,0.087901,0.088536,0.083341,0.081707,0.083535,0.077629,0.080397,0.082907,0.081372,0.08136,0.080451,0.082078,0.081377,0.07821,0.075401,0.071989,0.072221,0.074321,0.068737,0.068668,0.066881,0.068274,0.06802,0.064204,0.064661,0.067533,0.068278,0.067652,0.065832,0.065709,0.063682,0.064036,0.062168,0.060437,0.059106,0.06301,0.068444,0.06953,0.072869,0.083558,0.084326,0.076633,0.078879,0.078626,0.080144,0.082453,0.07768,0.074189,0.078447,0.079759,0.078697,0.085363,0.087621,0.086168,0.081744,0.081873,0.086398,0.090614,0.088472,0.079821,0.080473,0.078934,0.082764,0.082322,0.077631,0.07835,0.082589,0.086493,0.088704,0.085711,0.090485,0.090633,0.091552,0.088721,0.088951,0.085559,0.087403,0.089253,0.094123,0.094098,0.093671,0.096212,0.082644,0.08486,0.084734,0.082098,0.080504,0.076777,0.080197,0.077588,0.076027,0.076289,0.076982,0.079004,0.077354,0.069825,0.063015,0.063617,0.064567,0.059371,0.055501,0.050817,0.050071,0.053556,0.056659,0.059633,0.059642,0.058259,0.055402,0.054027,0.058392,0.057062,0.057497,0.057163,0.05841,0.058826,0.059405,0.057984,0.056647,0.056921,0.056193,0.056128,0.053005,0.051444,0.050434,0.047473,0.047608,0.051947,0.052649,0.050009,0.046968,0.045497,0.04486,0.046338,0.047047,0.049686,0.048842,0.046046,0.046739,0.048903,0.048315,0.048712,0.048893,0.04818,0.045702,0.043396,0.044254,0.044082,0.043729,0.043422,0.044786,0.045217,0.043959,0.043793,0.043849,0.046211,0.045501,0.045915,0.044586,0.044423,0.044963,0.044961,0.046231,0.046099,0.047106,0.048866,0.049907,0.05052,0.051348,0.047857,0.046264,0.036023,0.036352,0.035643,0.037209,0.038445,0.036642,0.036422,0.038396,0.037868,0.037876,0.037912,0.038844,0.038851,0.03863,0.040505,0.040972,0.040856,0.040562,0.040482,0.040512,0.04111,0.039367,0.037804,0.038169,0.037591,0.037832,0.038443,0.038694,0.03881,0.035786,0.036203,0.037581,0.039668,0.039637,0.042051,0.042259,0.041334,0.040456,0.04124,0.042069,0.041358,0.041607,0.043232,0.043826,0.042724,0.04138,0.042139,0.042388,0.042499,0.043227,0.04332,0.042399,0.042329,0.043511,0.04367,0.043543,0.041383,0.040809,0.037727,0.034611,0.036701,0.035556,0.033336,0.035705,0.035783,0.038641,0.039194,0.040068,0.038467,0.03758,0.037226,0.03655,0.036969,0.037478,0.038195,0.038386,0.037422,0.036295,0.036322,0.036249,0.036628,0.036087,0.034808,0.033589,0.031296,0.030885,0.033067,0.032871,0.03294,0.033212,0.03316,0.032905,0.033251,0.033544,0.032226,0.033079,0.03339,0.033493,0.032794,0.032704,0.032448,0.032491,0.033872,0.034545,0.034674,0.036653,0.036015,0.035673,0.034807,0.036522,0.03658,0.036776,0.036969,0.040407,0.040224,0.041106,0.043239,0.041412,0.04192,0.043469,0.045313,0.042231,0.041448,0.043071,0.042995,0.04423,0.047483,0.05255,0.052368,0.05227,0.053281,0.054925,0.05538,0.054237,0.055675,0.058259,0.059575,0.057607,0.059898,0.058466,0.058918,0.063193,0.065988,0.067465,0.062758,0.057385,0.056036,0.058283,0.057373,0.055936,0.057662,0.056981,0.058191,0.057519,0.056146,0.047374,0.046511,0.047081,0.047541,0.045262,0.045588,0.047843,0.048234,0.049015,0.050272,0.048554,0.042981,0.039271,0.040766,0.037656,0.023961,0.01913,0.025745,0.025821,0.02222,0.02411,0.024609,0.025305,0.027493,0.028104,0.027013,0.026753,0.028717,0.028975,0.029351,0.029214,0.02819,0.028225,0.028124,0.029682,0.029555,0.030841,0.031707,0.03187,0.0317,0.031934,0.034845,0.03512,0.035574,0.032544,0.032772,0.033075,0.03207,0.032781,0.031839,0.031242,null,0.034575,0.03563,0.034158,0.034032,0.034544,0.036524,0.040617,0.041398,0.042232,0.044644,0.046265,0.047019,0.047565,0.047776,0.049891,0.048311,0.046523,0.049049,0.048983,0.048857,0.050986,0.051522,0.045003,0.04549,0.047906,0.049724,0.050481,0.050014,0.050084,0.050913,0.051094,0.052858,0.05465,0.050575,0.05152,0.054495,0.052629,0.051129,0.052034,0.053223,0.05505,0.062897,0.063818,0.072597,0.073659,0.073968,0.077421,0.084407,0.084326,0.085176,0.083016,0.084601,0.083407,0.079992,0.074332,0.075169,0.077573,0.076386,0.06977,0.077061,0.077621,0.080377,0.078954,0.077441,0.078298,0.078432,0.081509,0.080589,0.079519,0.079859,0.076109,0.076251,0.080338,0.082026,0.082533,0.089062,0.092721,0.096143,0.094408,0.097334,0.103143,0.11554,0.118261,0.111033,0.117927,0.121197,0.122183,0.121564,0.12756,0.119481,0.121946,0.118482,0.121218,0.116941,0.116913,0.12063,0.123651,0.121051,0.121925,0.141286,0.130259,0.135519,0.13918,0.137262,0.136542,0.138498,0.130184,0.132596,0.136808,0.141659,0.140563,0.134989,0.138128,0.142817,0.142889,0.133464,0.12485,0.133638,0.138102,0.137334,0.136433,0.138397,0.136155,0.128147,0.127686,0.123127,0.120038,0.120498,0.120876,0.108372,0.111282,0.104409,0.106352,0.108782,0.114286,0.113617,0.120018,0.112024,0.095572,0.094082,0.087401,0.086839,0.08693,0.088923,0.089763,0.093433,0.093296,0.09532,0.092938,0.093579,0.093308,0.08993,0.091069,0.090015,0.090632,0.088361,0.078425,0.079868,0.076367,0.076059,0.082845,0.09303,0.094908,0.100503,0.097939,0.097262,0.096007,0.090471,0.092635,0.092884,0.096255,0.092168,0.090105,0.090903,null,0.101445,0.104381,null,null,0.105712,0.104979,0.102537,0.103366,0.105305,0.106188,0.101226,0.101831,0.105482,0.105602,0.107539,0.106178,0.09943,0.10207,0.09557,0.095,0.090363,0.092208,0.092853,0.091766,0.088048,0.092127,0.092214,0.096721,0.099408,0.100179,0.101456,0.103939,0.10554,0.102827,0.104062,0.101736,0.098801,0.099656,0.105112,0.103546,0.104525,0.105778,0.116771,0.12019,0.142471,0.153571,0.149907,0.123439,0.131366,0.13956,0.157614,0.1606,0.146573,0.151429,0.155936,0.146964,0.146795,0.15343,0.151737,0.138959,0.130468,0.139986,0.135182,0.139207,0.143477,0.149769,0.153355,0.149976,0.161644,0.159152,0.16332,0.158695,0.147903,0.149451,0.12742,0.132127,0.150497,0.149824,0.150378,0.153445,0.174039,0.175681,0.176594,0.172022,0.169233,0.173376,0.19445,0.208454,0.256225,0.283216,0.266476,0.296694,0.284556,0.233033,0.265727,0.272395,0.2998,0.280742,0.30225,0.342834,0.366233,0.363624,0.331958,0.301401,0.283576,0.336701,0.338756,0.341663,0.325815,0.305461,0.306104,0.332015,0.337469,0.338952,0.334194,0.388787,0.415046,0.410158,0.439556,0.522974,0.586949,0.634283,0.669399,0.703548,0.87195,0.871123,0.833003,0.815201,0.717115,0.840923,0.826491,0.890869,0.885282,0.916921,1.079321,0.851531,0.824145,0.902583,1.017986,0.99515,1.234138,1.166092,1.2393,1.188732,1.214234,1.069218,1.041156,1.090132,1.108308,1.107921,1.11332,1.12397,1.111643,1.03275,0.993052,1.059154,1.007628,1.004308,1.206662,1.237366,1.196046,1.206541,1.164746,1.089628,1.088027,1.056555,1.055945,1.098956,1.163149,1.169294,1.181512,1.191645,1.16772,1.18413,1.187607,1.171635,1.166279,1.176512,1.195389,1.165118,1.173156,1.194931,1.196311,1.200776,1.265474,1.283793,1.353006,1.415393,1.339908,1.368059,1.098977,1.174248,1.130647,1.200816,1.117599,0.935227,1.09696,1.022775,1.082105,1.224979,1.235215,1.26794,1.287837,1.319063,1.295577,1.322527,1.258929,1.26083,1.4338,1.530229,1.564084,1.575998,1.529308,1.596676,1.552775,1.505321,1.817152,1.966524,2.013285,1.92552,1.979631,1.028031,1.327412,1.326776,1.377943,1.056036,1.270361,1.439744,1.554463,1.612414,1.452245,1.335859,1.35182,1.527209,1.660549,1.719255,1.717762,1.609734,1.611715,1.647702,1.557106,1.402785,1.485165,1.508578,1.420852,1.358179,1.402935,1.510411,1.545383,1.475047,1.459475,1.379673,1.386422,1.308951,1.170604,1.002985,1.111894,1.206899,1.245304,1.198573,1.243678,1.305406,1.320304,1.287063,1.304074,1.286607,1.359664,1.382153,1.379284,1.393282,1.401327,1.320428,1.288597,1.320597,1.324434,1.292838,1.250801,1.200443,1.207396,1.168918,1.152655,1.170776,1.117248,1.021433,1.038182,1.152134,1.147738,1.199018,1.191617,1.224362,1.21536,1.260048,1.260992,1.250495,1.28886,1.30027,1.296775,1.263189,1.324366,1.34052,1.363699,1.39675,1.408625,1.394436,1.458569,1.670661,1.684125,1.828374,2.093593,2.039562,2.051724,1.912754,1.887675,2.047941,2.378612,2.387616,2.433664,2.693827,2.598319,2.608796,2.473766,2.498699,2.782474,2.730336,2.724317,2.706473,2.726327,2.839781,2.907606,2.810206,2.826377,2.804009,2.040953,2.211509,2.387085,2.302802,2.375493,2.511185,2.315688,2.328019,2.364347,2.383594,2.32671,2.313549,2.265415,1.989418,1.92328,1.970946,2.183468,2.077399,2.241186,2.153531,2.133972,2.030042,2.023027,2.053454,2.096256,2.195434,2.223882,2.1558,2.181561,2.116876,2.153612,2.223705,2.221574,2.174145,2.122026,2.075584,2.089565,2.161629],"open":[0.021678,0.024607,0.025757,0.020864,0.021951,0.021359,0.018414,0.020929,0.020344,0.022112,0.02148,0.022538,0.026061,0.033876,0.032874,0.029939,0.028953,0.027219,0.026704,0.026982,0.030806,0.028565,0.027684,0.025339,0.027038,0.027409,0.027138,0.026339,0.025831,0.028318,0.028547,0.029127,0.023079,0.021418,0.022641,0.022054,0.020977,0.021846,0.021912,0.02516,0.032219,0.026891,0.02748,0.024364,0.025797,0.026116,0.026583,0.027143,0.025597,0.026243,0.028152,0.029587,0.028399,0.02854,0.027406,0.028324,0.030437,0.036619,0.050627,0.118235,0.09493,0.116622,0.131633,0.132351,0.131546,0.135625,0.126748,0.117766,0.106142,0.114745,0.119794,0.108927,0.121177,0.133739,0.133667,0.233209,0.212875,0.386775,0.511939,0.520268,0.533705,0.490049,0.478974,0.41442,0.416661,0.39233,0.413573,0.427107,0.41202,0.410457,0.528316,0.642581,0.718847,0.724676,0.779681,1.09403,1.17115,0.997,1.02415,0.999329,0.898185,0.815872,0.791522,0.695769,0.91741,0.881961,0.795761,0.780621,0.624123,0.631295,0.649544,0.656564,0.706391,0.614983,0.566537,0.563369,0.629337,0.633903,0.623477,0.62056,0.669373,0.624799,0.527598,0.515912,0.41946,0.400965,0.433865,0.385044,0.331209,0.367267,0.344464,0.352848,0.386671,0.405104,0.372595,0.383436,0.373766,0.394671,0.410142,0.402403,0.418355,0.38693,0.390942,0.375593,0.362651,0.334758,0.343668,0.322152,0.345272,0.339132,0.334486,0.311973,0.304424,0.292952,0.296285,0.299897,0.295947,0.284674,0.24816,0.221286,0.225216,0.209721,0.224104,0.22311,0.22343,0.198755,0.186788,0.17877,0.153931,0.160749,0.193447,0.205315,0.215403,0.202298,0.188844,0.188396,0.18396,0.168215,0.155196,0.160143,0.146654,0.147115,0.156597,0.151691,0.157864,0.171158,0.155592,0.148394,0.144885,0.148825,0.157094,0.15324,0.156761,0.166757,0.211632,0.198675,0.201389,0.221889,0.25509,0.242734,0.267493,0.270986,0.302292,0.287488,0.285558,0.288539,0.312805,0.270795,0.294589,0.28713,0.36067,0.364297,0.342953,0.357602,0.371926,0.370777,0.361318,0.365933,0.349948,0.335595,0.328426,0.323879,0.296797,0.262649,0.27164,0.285852,0.274269,0.259082,0.257352,0.242816,0.246199,0.243143,0.25613,0.249397,0.224393,0.203324,0.20906,0.199761,0.196354,0.193696,0.175475,0.203685,0.210393,0.224533,0.222701,0.2277,0.228155,0.214247,0.220565,0.216105,0.210831,0.20526,0.201517,0.176262,0.181348,0.166136,0.16025,0.172218,0.162741,0.163137,0.161122,0.164702,0.166781,0.162051,0.15846,0.140334,0.138355,0.132321,0.135623,0.126551,0.127393,0.119397,0.126036,0.138264,0.142591,0.158522,0.1502,0.151597,0.148749,0.146257,0.149953,0.145345,0.139729,0.128801,0.13156,0.127299,0.138365,0.137029,0.142277,0.154915,0.170299,0.178986,0.179893,0.161994,0.163874,0.169526,0.164736,0.17236,0.172416,0.16445,0.166228,0.164163,0.163234,0.154067,0.143086,0.141316,0.131416,0.130771,0.127292,0.130919,0.130923,0.125594,0.114507,0.124091,0.116444,0.112497,0.113183,0.102779,0.095489,0.095036,0.095682,0.109847,0.099744,0.102243,0.093161,0.095016,0.090205,0.092846,0.094305,0.094262,0.093178,0.100565,0.105611,0.105205,0.100902,0.101877,0.106903,0.10465,0.103484,0.105267,0.087525,0.088521,0.08412,0.078443,0.077277,0.07418,0.070794,0.067053,0.070094,0.067928,0.069153,0.069854,0.063568,0.069146,0.072439,0.081778,0.08766,0.083488,0.089706,0.082303,0.080992,0.079466,0.086403,0.083712,0.084368,0.085292,0.084604,0.082032,0.080818,0.081381,0.083309,0.081454,0.084531,0.086773,0.086345,0.084525,0.070339,0.072637,0.073063,0.070436,0.074788,0.07586,0.077536,0.075022,0.075789,0.076305,0.075754,0.075864,0.074612,0.074289,0.073748,0.073687,0.07303,0.073042,0.069632,0.069723,0.069698,0.070814,0.072561,0.071492,0.075961,0.076337,0.08102,0.078391,0.076324,0.074167,0.075165,0.076818,0.075883,0.073439,0.064847,0.063242,0.061062,0.060803,0.061903,0.052658,0.045149,0.047885,0.044062,0.04342,0.038628,0.037761,0.035682,0.03651,0.042269,0.041984,0.038991,0.04135,0.041874,0.038557,0.037659,0.034318,0.030797,0.029812,0.030643,0.031653,0.030117,0.029439,0.030635,0.029235,0.028395,0.028203,0.029175,0.03282,0.034863,0.034212,0.039079,0.040658,0.042203,0.044286,0.045675,0.041603,0.041225,0.037017,0.041873,0.041597,0.043232,0.040984,0.042568,0.045106,0.042629,0.043659,0.044709,0.049266,0.04814,0.048567,0.052049,0.044322,0.044154,0.043812,0.040249,0.044157,0.042768,0.044868,0.045308,0.044275,0.045674,0.043541,0.042889,0.043548,0.042937,0.043097,0.042687,0.042666,0.041137,0.038713,0.038177,0.039699,0.038441,0.038598,0.039259,0.03813,0.037824,0.037993,0.036651,0.036399,0.040775,0.04105,0.042772,0.04168,0.041755,0.041136,0.040536,0.040619,0.041027,0.041468,0.045682,0.046177,0.047584,0.045041,0.045982,0.048727,0.042168,0.043965,0.043329,0.043245,0.043112,0.043217,0.042853,0.042303,0.040599,0.043185,0.04285,0.042952,0.042686,0.046754,0.045697,0.047665,0.047366,0.046575,0.047986,0.050112,0.0516,0.050311,0.050457,0.052719,0.053957,0.052906,0.057993,0.063723,0.06185,0.059206,0.062232,0.067593,0.065763,0.071257,0.071739,0.069651,0.07231,0.085437,0.090518,0.087355,0.091214,0.090161,0.090466,0.086989,0.083779,0.089929,0.083584,0.083485,0.083731,0.084643,0.082265,0.083785,0.083066,0.081739,0.079515,0.076556,0.074101,0.078067,0.074524,0.072643,0.069347,0.069211,0.070189,0.06862,0.064661,0.070338,0.06902,0.068575,0.069858,0.066907,0.066164,0.066759,0.064017,0.064606,0.061695,0.063355,0.075145,0.070086,0.073016,0.084562,0.093996,0.088207,0.08326,0.079063,0.086962,0.084844,0.084603,0.077914,0.080725,0.080869,0.080502,0.086038,0.091549,0.092874,0.090832,0.08451,0.089462,0.090695,0.096586,0.088447,0.082719,0.083391,0.083406,0.085856,0.084205,0.07943,0.085595,0.087998,0.096331,0.089776,0.090657,0.091695,0.092291,0.093596,0.089155,0.089979,0.087403,0.089629,0.094403,0.096644,0.097813,0.096357,0.097757,0.086482,0.089297,0.090486,0.082098,0.0838,0.081033,0.083007,0.077805,0.076518,0.077346,0.079932,0.080452,0.078012,0.071934,0.065181,0.069805,0.066795,0.059413,0.059516,0.051953,0.055235,0.058772,0.059808,0.062944,0.061208,0.059463,0.055812,0.059073,0.058678,0.062884,0.059875,0.059379,0.060414,0.059942,0.06016,0.058864,0.057417,0.05777,0.05627,0.056652,0.053374,0.051906,0.05191,0.047641,0.051992,0.054796,0.052932,0.052554,0.04709,0.047536,0.046869,0.047424,0.050725,0.050251,0.049226,0.047153,0.04941,0.049802,0.05017,0.049454,0.049706,0.049863,0.045835,0.044716,0.044824,0.044952,0.044555,0.045376,0.046784,0.045504,0.044437,0.044426,0.046211,0.046706,0.046903,0.046496,0.044993,0.045462,0.045758,0.046507,0.046815,0.04711,0.048949,0.053296,0.052491,0.052335,0.051894,0.049045,0.046259,0.03761,0.039412,0.03823,0.03951,0.038828,0.037474,0.038886,0.038507,0.0394,0.038362,0.039655,0.039713,0.039305,0.041676,0.041442,0.042629,0.041701,0.04054,0.04054,0.041325,0.041796,0.03976,0.038726,0.039527,0.038079,0.039217,0.039543,0.039271,0.03882,0.036409,0.037678,0.04122,0.040537,0.042315,0.042328,0.043428,0.041963,0.041645,0.042336,0.042581,0.041889,0.043261,0.044301,0.044928,0.043644,0.042298,0.042438,0.043971,0.043257,0.043722,0.043489,0.04313,0.043978,0.044153,0.045403,0.043697,0.042588,0.041169,0.038447,0.037159,0.038371,0.035543,0.036046,0.036955,0.039129,0.039227,0.041416,0.040426,0.039612,0.038047,0.037906,0.037402,0.037879,0.038312,0.038753,0.038932,0.037474,0.036602,0.036652,0.036719,0.03716,0.036449,0.036662,0.034269,0.031794,0.034456,0.033264,0.034,0.033265,0.034441,0.033195,0.034185,0.033745,0.034279,0.033095,0.033637,0.034278,0.033607,0.032832,0.033474,0.032748,0.034191,0.034574,0.034751,0.037291,0.037055,0.036445,0.036335,0.036854,0.036821,0.037696,0.037041,0.04158,0.042572,0.041435,0.044985,0.044851,0.04192,0.043811,0.045939,0.045659,0.04338,0.044968,0.043247,0.044627,0.047839,0.052897,0.053469,0.056034,0.053836,0.05611,0.055724,0.056966,0.055985,0.059243,0.059756,0.059752,0.059938,0.061824,0.060345,0.063193,0.068333,0.068587,0.07058,0.063989,0.06256,0.06006,0.062604,0.05743,0.058186,0.058577,0.058323,0.061544,0.058953,0.056296,0.049436,0.049662,0.048608,0.047506,0.045884,0.048913,0.048761,0.049015,0.051041,0.051528,0.048927,0.043231,0.041554,0.041494,0.039627,0.023954,0.028462,0.025959,0.027111,0.02411,0.025209,0.025315,0.030415,0.029366,0.029446,0.027089,0.029092,0.030187,0.029438,0.030729,0.029254,0.029738,0.028218,0.029825,0.030553,0.030841,0.031961,0.032295,0.032517,0.031999,0.035655,0.035131,0.036279,0.036162,0.033215,0.033329,0.033782,0.033123,0.032959,0.0319,null,0.034623,0.036573,0.035806,0.03416,0.034688,0.03657,0.040617,0.04187,0.042405,0.045938,0.04663,0.04723,0.051717,0.047826,0.051196,0.051032,0.048964,0.049668,0.049302,0.04974,0.051083,0.052259,0.051744,0.047696,0.048094,0.050367,0.051365,0.050866,0.050423,0.050913,0.051294,0.054224,0.056459,0.056869,0.052283,0.05584,0.055265,0.052188,0.053881,0.05348,0.05512,0.064645,0.064777,0.076905,0.074244,0.080983,0.078518,0.085364,0.08905,0.085449,0.086035,0.086703,0.086444,0.083394,0.08354,0.075368,0.079613,0.079103,0.076748,0.078381,0.079085,0.083445,0.082139,0.079603,0.079318,0.078472,0.083412,0.082992,0.082616,0.081732,0.080558,0.077679,0.080392,0.083848,0.083112,0.096897,0.094318,0.096652,0.099965,0.098211,0.104957,0.11749,0.129908,0.12423,0.118349,0.125341,0.126783,0.124269,0.131996,0.130397,0.125964,0.122307,0.122484,0.123723,0.117904,0.122981,0.123967,0.123918,0.121925,0.142971,0.147891,0.138762,0.148647,0.139968,0.140673,0.138798,0.143756,0.133498,0.137332,0.143129,0.142704,0.14408,0.139089,0.146315,0.145381,0.143709,0.137424,0.137499,0.141318,0.138284,0.138345,0.138471,0.140818,0.137427,0.129309,0.133536,0.123747,0.125151,0.121581,0.124525,0.113347,0.115258,0.106875,0.109474,0.116668,0.117493,0.12261,0.125477,0.115538,0.095987,0.10239,0.089923,0.093072,0.093237,0.091149,0.093433,0.097156,0.097112,0.097598,0.094906,0.096809,0.093398,0.091655,0.094217,0.090884,0.091662,0.089459,0.080448,0.081754,0.076806,0.0829,0.096892,0.095578,0.101206,0.100703,0.101116,0.101202,0.097894,0.092913,0.093684,0.096301,0.097634,0.092909,0.093944,null,0.101466,0.104902,null,null,0.109298,0.107217,0.106748,0.104218,0.106044,0.107416,0.108614,0.102519,0.106056,0.110698,0.108083,0.108075,0.106351,0.103097,0.102827,0.098977,0.095376,0.093369,0.093056,0.098197,0.092143,0.093435,0.095369,0.096994,0.109105,0.101379,0.106621,0.105326,0.105805,0.105965,0.104525,0.106391,0.104202,0.100531,0.10548,0.1096,0.106402,0.105866,0.118226,0.132945,0.14476,0.153571,0.166346,0.155107,0.138292,0.141074,0.164923,0.16663,0.171367,0.155956,0.158592,0.164209,0.148164,0.159659,0.158876,0.154127,0.140942,0.14817,0.142022,0.139423,0.144503,0.154016,0.158065,0.154312,0.167571,0.163449,0.16498,0.164728,0.162004,0.152634,0.156226,0.136457,0.152886,0.157556,0.157835,0.15444,0.176709,0.192022,0.184034,0.181382,0.175359,0.177382,0.205236,0.224817,0.258549,0.332272,0.300387,0.305611,0.332961,0.304996,0.275249,0.286688,0.313546,0.310554,0.302512,0.352337,0.379735,0.371457,0.368936,0.375449,0.310054,0.349332,0.345586,0.35385,0.343841,0.344218,0.313021,0.352348,0.348078,0.362608,0.344817,0.402952,0.425959,0.441357,0.441142,0.537758,0.628832,0.66238,0.682145,0.703548,0.930823,0.927095,0.925421,0.90633,0.847825,0.860703,0.87091,0.890869,0.914256,0.927462,1.121584,1.100406,1.098769,0.954958,1.051349,1.080828,1.242145,1.323619,1.309792,1.293609,1.225719,1.216445,1.114639,1.167456,1.130849,1.132939,1.118145,1.195103,1.134413,1.124823,1.038894,1.102982,1.058601,1.033242,1.243555,1.378416,1.238559,1.301472,1.206431,1.189203,1.109343,1.121345,1.074466,1.101425,1.214082,1.17682,1.190976,1.202562,1.213675,1.193553,1.189208,1.196326,1.172973,1.191552,1.214279,1.255457,1.176132,1.219454,1.203533,1.218359,1.266206,1.314895,1.410999,1.453804,1.479627,1.413843,1.386181,1.278005,1.194609,1.267735,1.203901,1.145824,1.158783,1.102703,1.090186,1.237595,1.305966,1.337107,1.306196,1.352431,1.351402,1.326938,1.362939,1.270986,1.47811,1.648683,1.654544,1.620347,1.766068,1.641717,1.763505,1.56845,1.927283,2.006624,2.171434,2.30019,2.028103,2.006584,1.471961,1.802594,1.553113,1.46568,1.316236,1.550373,1.554463,1.781137,1.650636,1.513623,1.404303,1.575644,1.738447,1.736103,1.754643,1.846715,1.709916,1.656461,1.677226,1.567051,1.583486,1.627778,1.533137,1.437721,1.480494,1.557019,1.57387,1.55658,1.484558,1.482789,1.417603,1.387408,1.427028,1.175233,1.155804,1.25141,1.359522,1.254301,1.251827,1.337114,1.325513,1.372968,1.383814,1.332942,1.394152,1.404008,1.461221,1.404712,1.416153,1.404964,1.327267,1.350715,1.335172,1.348264,1.313973,1.264938,1.263694,1.22505,1.171585,1.172851,1.181999,1.12276,1.054299,1.170252,1.18625,1.207072,1.233566,1.228722,1.255928,1.280826,1.286494,1.285791,1.309885,1.319958,1.31577,1.30939,1.369783,1.376939,1.386193,1.402523,1.473097,1.426617,1.475262,1.677949,1.795803,1.83276,2.138287,2.189896,2.167868,2.072315,1.92448,2.105524,2.437795,2.457214,2.436862,2.708616,2.920038,2.725629,2.741166,2.531772,2.947338,2.850029,2.850741,2.737641,2.769947,2.86975,2.959315,2.96639,2.831425,2.911581,2.832807,2.506859,2.406712,2.517666,2.385186,2.641341,2.582778,2.403186,2.397332,2.503889,2.418439,2.347429,2.369956,2.283438,2.079772,1.984266,2.259691,2.329006,2.279395,2.302443,2.212038,2.133217,2.039015,2.066589,2.116249,2.254531,2.249317,2.251848,2.189178,2.233087,2.210038,2.277983,2.234527,2.267288,2.191907,2.173525,2.119377,2.195967],"x":["2017-10-01","2017-10-02","2017-10-03","2017-10-04","2017-10-05","2017-10-06","2017-10-07","2017-10-08","2017-10-09","2017-10-10","2017-10-11","2017-10-12","2017-10-13","2017-10-14","2017-10-15","2017-10-16","2017-10-17","2017-10-18","2017-10-19","2017-10-20","2017-10-21","2017-10-22","2017-10-23","2017-10-24","2017-10-25","2017-10-26","2017-10-27","2017-10-28","2017-10-29","2017-10-30","2017-10-31","2017-11-01","2017-11-02","2017-11-03","2017-11-04","2017-11-05","2017-11-06","2017-11-07","2017-11-08","2017-11-09","2017-11-10","2017-11-11","2017-11-12","2017-11-13","2017-11-14","2017-11-15","2017-11-16","2017-11-17","2017-11-18","2017-11-19","2017-11-20","2017-11-21","2017-11-22","2017-11-23","2017-11-24","2017-11-25","2017-11-26","2017-11-27","2017-11-28","2017-11-29","2017-11-30","2017-12-01","2017-12-02","2017-12-03","2017-12-04","2017-12-05","2017-12-06","2017-12-07","2017-12-08","2017-12-09","2017-12-10","2017-12-11","2017-12-12","2017-12-13","2017-12-14","2017-12-15","2017-12-16","2017-12-17","2017-12-18","2017-12-19","2017-12-20","2017-12-21","2017-12-22","2017-12-23","2017-12-24","2017-12-25","2017-12-26","2017-12-27","2017-12-28","2017-12-29","2017-12-30","2017-12-31","2018-01-01","2018-01-02","2018-01-03","2018-01-04","2018-01-05","2018-01-06","2018-01-07","2018-01-08","2018-01-09","2018-01-10","2018-01-11","2018-01-12","2018-01-13","2018-01-14","2018-01-15","2018-01-16","2018-01-17","2018-01-18","2018-01-19","2018-01-20","2018-01-21","2018-01-22","2018-01-23","2018-01-24","2018-01-25","2018-01-26","2018-01-27","2018-01-28","2018-01-29","2018-01-30","2018-01-31","2018-02-01","2018-02-02","2018-02-03","2018-02-04","2018-02-05","2018-02-06","2018-02-07","2018-02-08","2018-02-09","2018-02-10","2018-02-11","2018-02-12","2018-02-13","2018-02-14","2018-02-15","2018-02-16","2018-02-17","2018-02-18","2018-02-19","2018-02-20","2018-02-21","2018-02-22","2018-02-23","2018-02-24","2018-02-25","2018-02-26","2018-02-27","2018-02-28","2018-03-01","2018-03-02","2018-03-03","2018-03-04","2018-03-05","2018-03-06","2018-03-07","2018-03-08","2018-03-09","2018-03-10","2018-03-11","2018-03-12","2018-03-13","2018-03-14","2018-03-15","2018-03-16","2018-03-17","2018-03-18","2018-03-19","2018-03-20","2018-03-21","2018-03-22","2018-03-23","2018-03-24","2018-03-25","2018-03-26","2018-03-27","2018-03-28","2018-03-29","2018-03-30","2018-03-31","2018-04-01","2018-04-02","2018-04-03","2018-04-04","2018-04-05","2018-04-06","2018-04-07","2018-04-08","2018-04-09","2018-04-10","2018-04-11","2018-04-12","2018-04-13","2018-04-14","2018-04-15","2018-04-16","2018-04-17","2018-04-18","2018-04-19","2018-04-20","2018-04-21","2018-04-22","2018-04-23","2018-04-24","2018-04-25","2018-04-26","2018-04-27","2018-04-28","2018-04-29","2018-04-30","2018-05-01","2018-05-02","2018-05-03","2018-05-04","2018-05-05","2018-05-06","2018-05-07","2018-05-08","2018-05-09","2018-05-10","2018-05-11","2018-05-12","2018-05-13","2018-05-14","2018-05-15","2018-05-16","2018-05-17","2018-05-18","2018-05-19","2018-05-20","2018-05-21","2018-05-22","2018-05-23","2018-05-24","2018-05-25","2018-05-26","2018-05-27","2018-05-28","2018-05-29","2018-05-30","2018-05-31","2018-06-01","2018-06-02","2018-06-03","2018-06-04","2018-06-05","2018-06-06","2018-06-07","2018-06-08","2018-06-09","2018-06-10","2018-06-11","2018-06-12","2018-06-13","2018-06-14","2018-06-15","2018-06-16","2018-06-17","2018-06-18","2018-06-19","2018-06-20","2018-06-21","2018-06-22","2018-06-23","2018-06-24","2018-06-25","2018-06-26","2018-06-27","2018-06-28","2018-06-29","2018-06-30","2018-07-01","2018-07-02","2018-07-03","2018-07-04","2018-07-05","2018-07-06","2018-07-07","2018-07-08","2018-07-09","2018-07-10","2018-07-11","2018-07-12","2018-07-13","2018-07-14","2018-07-15","2018-07-16","2018-07-17","2018-07-18","2018-07-19","2018-07-20","2018-07-21","2018-07-22","2018-07-23","2018-07-24","2018-07-25","2018-07-26","2018-07-27","2018-07-28","2018-07-29","2018-07-30","2018-07-31","2018-08-01","2018-08-02","2018-08-03","2018-08-04","2018-08-05","2018-08-06","2018-08-07","2018-08-08","2018-08-09","2018-08-10","2018-08-11","2018-08-12","2018-08-13","2018-08-14","2018-08-15","2018-08-16","2018-08-17","2018-08-18","2018-08-19","2018-08-20","2018-08-21","2018-08-22","2018-08-23","2018-08-24","2018-08-25","2018-08-26","2018-08-27","2018-08-28","2018-08-29","2018-08-30","2018-08-31","2018-09-01","2018-09-02","2018-09-03","2018-09-04","2018-09-05","2018-09-06","2018-09-07","2018-09-08","2018-09-09","2018-09-10","2018-09-11","2018-09-12","2018-09-13","2018-09-14","2018-09-15","2018-09-16","2018-09-17","2018-09-18","2018-09-19","2018-09-20","2018-09-21","2018-09-22","2018-09-23","2018-09-24","2018-09-25","2018-09-26","2018-09-27","2018-09-28","2018-09-29","2018-09-30","2018-10-01","2018-10-02","2018-10-03","2018-10-04","2018-10-05","2018-10-06","2018-10-07","2018-10-08","2018-10-09","2018-10-10","2018-10-11","2018-10-12","2018-10-13","2018-10-14","2018-10-15","2018-10-16","2018-10-17","2018-10-18","2018-10-19","2018-10-20","2018-10-21","2018-10-22","2018-10-23","2018-10-24","2018-10-25","2018-10-26","2018-10-27","2018-10-28","2018-10-29","2018-10-30","2018-10-31","2018-11-01","2018-11-02","2018-11-03","2018-11-04","2018-11-05","2018-11-06","2018-11-07","2018-11-08","2018-11-09","2018-11-10","2018-11-11","2018-11-12","2018-11-13","2018-11-14","2018-11-15","2018-11-16","2018-11-17","2018-11-18","2018-11-19","2018-11-20","2018-11-21","2018-11-22","2018-11-23","2018-11-24","2018-11-25","2018-11-26","2018-11-27","2018-11-28","2018-11-29","2018-11-30","2018-12-01","2018-12-02","2018-12-03","2018-12-04","2018-12-05","2018-12-06","2018-12-07","2018-12-08","2018-12-09","2018-12-10","2018-12-11","2018-12-12","2018-12-13","2018-12-14","2018-12-15","2018-12-16","2018-12-17","2018-12-18","2018-12-19","2018-12-20","2018-12-21","2018-12-22","2018-12-23","2018-12-24","2018-12-25","2018-12-26","2018-12-27","2018-12-28","2018-12-29","2018-12-30","2018-12-31","2019-01-01","2019-01-02","2019-01-03","2019-01-04","2019-01-05","2019-01-06","2019-01-07","2019-01-08","2019-01-09","2019-01-10","2019-01-11","2019-01-12","2019-01-13","2019-01-14","2019-01-15","2019-01-16","2019-01-17","2019-01-18","2019-01-19","2019-01-20","2019-01-21","2019-01-22","2019-01-23","2019-01-24","2019-01-25","2019-01-26","2019-01-27","2019-01-28","2019-01-29","2019-01-30","2019-01-31","2019-02-01","2019-02-02","2019-02-03","2019-02-04","2019-02-05","2019-02-06","2019-02-07","2019-02-08","2019-02-09","2019-02-10","2019-02-11","2019-02-12","2019-02-13","2019-02-14","2019-02-15","2019-02-16","2019-02-17","2019-02-18","2019-02-19","2019-02-20","2019-02-21","2019-02-22","2019-02-23","2019-02-24","2019-02-25","2019-02-26","2019-02-27","2019-02-28","2019-03-01","2019-03-02","2019-03-03","2019-03-04","2019-03-05","2019-03-06","2019-03-07","2019-03-08","2019-03-09","2019-03-10","2019-03-11","2019-03-12","2019-03-13","2019-03-14","2019-03-15","2019-03-16","2019-03-17","2019-03-18","2019-03-19","2019-03-20","2019-03-21","2019-03-22","2019-03-23","2019-03-24","2019-03-25","2019-03-26","2019-03-27","2019-03-28","2019-03-29","2019-03-30","2019-03-31","2019-04-01","2019-04-02","2019-04-03","2019-04-04","2019-04-05","2019-04-06","2019-04-07","2019-04-08","2019-04-09","2019-04-10","2019-04-11","2019-04-12","2019-04-13","2019-04-14","2019-04-15","2019-04-16","2019-04-17","2019-04-18","2019-04-19","2019-04-20","2019-04-21","2019-04-22","2019-04-23","2019-04-24","2019-04-25","2019-04-26","2019-04-27","2019-04-28","2019-04-29","2019-04-30","2019-05-01","2019-05-02","2019-05-03","2019-05-04","2019-05-05","2019-05-06","2019-05-07","2019-05-08","2019-05-09","2019-05-10","2019-05-11","2019-05-12","2019-05-13","2019-05-14","2019-05-15","2019-05-16","2019-05-17","2019-05-18","2019-05-19","2019-05-20","2019-05-21","2019-05-22","2019-05-23","2019-05-24","2019-05-25","2019-05-26","2019-05-27","2019-05-28","2019-05-29","2019-05-30","2019-05-31","2019-06-01","2019-06-02","2019-06-03","2019-06-04","2019-06-05","2019-06-06","2019-06-07","2019-06-08","2019-06-09","2019-06-10","2019-06-11","2019-06-12","2019-06-13","2019-06-14","2019-06-15","2019-06-16","2019-06-17","2019-06-18","2019-06-19","2019-06-20","2019-06-21","2019-06-22","2019-06-23","2019-06-24","2019-06-25","2019-06-26","2019-06-27","2019-06-28","2019-06-29","2019-06-30","2019-07-01","2019-07-02","2019-07-03","2019-07-04","2019-07-05","2019-07-06","2019-07-07","2019-07-08","2019-07-09","2019-07-10","2019-07-11","2019-07-12","2019-07-13","2019-07-14","2019-07-15","2019-07-16","2019-07-17","2019-07-18","2019-07-19","2019-07-20","2019-07-21","2019-07-22","2019-07-23","2019-07-24","2019-07-25","2019-07-26","2019-07-27","2019-07-28","2019-07-29","2019-07-30","2019-07-31","2019-08-01","2019-08-02","2019-08-03","2019-08-04","2019-08-05","2019-08-06","2019-08-07","2019-08-08","2019-08-09","2019-08-10","2019-08-11","2019-08-12","2019-08-13","2019-08-14","2019-08-15","2019-08-16","2019-08-17","2019-08-18","2019-08-19","2019-08-20","2019-08-21","2019-08-22","2019-08-23","2019-08-24","2019-08-25","2019-08-26","2019-08-27","2019-08-28","2019-08-29","2019-08-30","2019-08-31","2019-09-01","2019-09-02","2019-09-03","2019-09-04","2019-09-05","2019-09-06","2019-09-07","2019-09-08","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-27","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-04","2019-12-05","2019-12-06","2019-12-07","2019-12-08","2019-12-09","2019-12-10","2019-12-11","2019-12-12","2019-12-13","2019-12-14","2019-12-15","2019-12-16","2019-12-17","2019-12-18","2019-12-19","2019-12-20","2019-12-21","2019-12-22","2019-12-23","2019-12-24","2019-12-25","2019-12-26","2019-12-27","2019-12-28","2019-12-29","2019-12-30","2019-12-31","2020-01-01","2020-01-02","2020-01-03","2020-01-04","2020-01-05","2020-01-06","2020-01-07","2020-01-08","2020-01-09","2020-01-10","2020-01-11","2020-01-12","2020-01-13","2020-01-14","2020-01-15","2020-01-16","2020-01-17","2020-01-18","2020-01-19","2020-01-20","2020-01-21","2020-01-22","2020-01-23","2020-01-24","2020-01-25","2020-01-26","2020-01-27","2020-01-28","2020-01-29","2020-01-30","2020-01-31","2020-02-01","2020-02-02","2020-02-03","2020-02-04","2020-02-05","2020-02-06","2020-02-07","2020-02-08","2020-02-09","2020-02-10","2020-02-11","2020-02-12","2020-02-13","2020-02-14","2020-02-15","2020-02-16","2020-02-17","2020-02-18","2020-02-19","2020-02-20","2020-02-21","2020-02-22","2020-02-23","2020-02-24","2020-02-25","2020-02-26","2020-02-27","2020-02-28","2020-02-29","2020-03-01","2020-03-02","2020-03-03","2020-03-04","2020-03-05","2020-03-06","2020-03-07","2020-03-08","2020-03-09","2020-03-10","2020-03-11","2020-03-12","2020-03-13","2020-03-14","2020-03-15","2020-03-16","2020-03-17","2020-03-18","2020-03-19","2020-03-20","2020-03-21","2020-03-22","2020-03-23","2020-03-24","2020-03-25","2020-03-26","2020-03-27","2020-03-28","2020-03-29","2020-03-30","2020-03-31","2020-04-01","2020-04-02","2020-04-03","2020-04-04","2020-04-05","2020-04-06","2020-04-07","2020-04-08","2020-04-09","2020-04-10","2020-04-11","2020-04-12","2020-04-13","2020-04-14","2020-04-15","2020-04-16","2020-04-17","2020-04-18","2020-04-19","2020-04-20","2020-04-21","2020-04-22","2020-04-23","2020-04-24","2020-04-25","2020-04-26","2020-04-27","2020-04-28","2020-04-29","2020-04-30","2020-05-01","2020-05-02","2020-05-03","2020-05-04","2020-05-05","2020-05-06","2020-05-07","2020-05-08","2020-05-09","2020-05-10","2020-05-11","2020-05-12","2020-05-13","2020-05-14","2020-05-15","2020-05-16","2020-05-17","2020-05-18","2020-05-19","2020-05-20","2020-05-21","2020-05-22","2020-05-23","2020-05-24","2020-05-25","2020-05-26","2020-05-27","2020-05-28","2020-05-29","2020-05-30","2020-05-31","2020-06-01","2020-06-02","2020-06-03","2020-06-04","2020-06-05","2020-06-06","2020-06-07","2020-06-08","2020-06-09","2020-06-10","2020-06-11","2020-06-12","2020-06-13","2020-06-14","2020-06-15","2020-06-16","2020-06-17","2020-06-18","2020-06-19","2020-06-20","2020-06-21","2020-06-22","2020-06-23","2020-06-24","2020-06-25","2020-06-26","2020-06-27","2020-06-28","2020-06-29","2020-06-30","2020-07-01","2020-07-02","2020-07-03","2020-07-04","2020-07-05","2020-07-06","2020-07-07","2020-07-08","2020-07-09","2020-07-10","2020-07-11","2020-07-12","2020-07-13","2020-07-14","2020-07-15","2020-07-16","2020-07-17","2020-07-18","2020-07-19","2020-07-20","2020-07-21","2020-07-22","2020-07-23","2020-07-24","2020-07-25","2020-07-26","2020-07-27","2020-07-28","2020-07-29","2020-07-30","2020-07-31","2020-08-01","2020-08-02","2020-08-03","2020-08-04","2020-08-05","2020-08-06","2020-08-07","2020-08-08","2020-08-09","2020-08-10","2020-08-11","2020-08-12","2020-08-13","2020-08-14","2020-08-15","2020-08-16","2020-08-17","2020-08-18","2020-08-19","2020-08-20","2020-08-21","2020-08-22","2020-08-23","2020-08-24","2020-08-25","2020-08-26","2020-08-27","2020-08-28","2020-08-29","2020-08-30","2020-08-31","2020-09-01","2020-09-02","2020-09-03","2020-09-04","2020-09-05","2020-09-06","2020-09-07","2020-09-08","2020-09-09","2020-09-10","2020-09-11","2020-09-12","2020-09-13","2020-09-14","2020-09-15","2020-09-16","2020-09-17","2020-09-18","2020-09-19","2020-09-20","2020-09-21","2020-09-22","2020-09-23","2020-09-24","2020-09-25","2020-09-26","2020-09-27","2020-09-28","2020-09-29","2020-09-30","2020-10-01","2020-10-02","2020-10-03","2020-10-04","2020-10-05","2020-10-06","2020-10-07","2020-10-08","2020-10-09","2020-10-10","2020-10-11","2020-10-12","2020-10-13","2020-10-14","2020-10-15","2020-10-16","2020-10-17","2020-10-18","2020-10-19","2020-10-20","2020-10-21","2020-10-22","2020-10-23","2020-10-24","2020-10-25","2020-10-26","2020-10-27","2020-10-28","2020-10-29","2020-10-30","2020-10-31","2020-11-01","2020-11-02","2020-11-03","2020-11-04","2020-11-05","2020-11-06","2020-11-07","2020-11-08","2020-11-09","2020-11-10","2020-11-11","2020-11-12","2020-11-13","2020-11-14","2020-11-15","2020-11-16","2020-11-17","2020-11-18","2020-11-19","2020-11-20","2020-11-21","2020-11-22","2020-11-23","2020-11-24","2020-11-25","2020-11-26","2020-11-27","2020-11-28","2020-11-29","2020-11-30","2020-12-01","2020-12-02","2020-12-03","2020-12-04","2020-12-05","2020-12-06","2020-12-07","2020-12-08","2020-12-09","2020-12-10","2020-12-11","2020-12-12","2020-12-13","2020-12-14","2020-12-15","2020-12-16","2020-12-17","2020-12-18","2020-12-19","2020-12-20","2020-12-21","2020-12-22","2020-12-23","2020-12-24","2020-12-25","2020-12-26","2020-12-27","2020-12-28","2020-12-29","2020-12-30","2020-12-31","2021-01-01","2021-01-02","2021-01-03","2021-01-04","2021-01-05","2021-01-06","2021-01-07","2021-01-08","2021-01-09","2021-01-10","2021-01-11","2021-01-12","2021-01-13","2021-01-14","2021-01-15","2021-01-16","2021-01-17","2021-01-18","2021-01-19","2021-01-20","2021-01-21","2021-01-22","2021-01-23","2021-01-24","2021-01-25","2021-01-26","2021-01-27","2021-01-28","2021-01-29","2021-01-30","2021-01-31","2021-02-01","2021-02-02","2021-02-03","2021-02-04","2021-02-05","2021-02-06","2021-02-07","2021-02-08","2021-02-09","2021-02-10","2021-02-11","2021-02-12","2021-02-13","2021-02-14","2021-02-15","2021-02-16","2021-02-17","2021-02-18","2021-02-19","2021-02-20","2021-02-21","2021-02-22","2021-02-23","2021-02-24","2021-02-25","2021-02-26","2021-02-27","2021-02-28","2021-03-01","2021-03-02","2021-03-03","2021-03-04","2021-03-05","2021-03-06","2021-03-07","2021-03-08","2021-03-09","2021-03-10","2021-03-11","2021-03-12","2021-03-13","2021-03-14","2021-03-15","2021-03-16","2021-03-17","2021-03-18","2021-03-19","2021-03-20","2021-03-21","2021-03-22","2021-03-23","2021-03-24","2021-03-25","2021-03-26","2021-03-27","2021-03-28","2021-03-29","2021-03-30","2021-03-31","2021-04-01","2021-04-02","2021-04-03","2021-04-04","2021-04-05","2021-04-06","2021-04-07","2021-04-08","2021-04-09","2021-04-10","2021-04-11","2021-04-12","2021-04-13","2021-04-14","2021-04-15","2021-04-16","2021-04-17","2021-04-18","2021-04-19","2021-04-20","2021-04-21","2021-04-22","2021-04-23","2021-04-24","2021-04-25","2021-04-26","2021-04-27","2021-04-28","2021-04-29","2021-04-30","2021-05-01","2021-05-02","2021-05-03","2021-05-04","2021-05-05","2021-05-06","2021-05-07","2021-05-08","2021-05-09","2021-05-10","2021-05-11","2021-05-12","2021-05-13","2021-05-14","2021-05-15","2021-05-16","2021-05-17","2021-05-18","2021-05-19","2021-05-20","2021-05-21","2021-05-22","2021-05-23","2021-05-24","2021-05-25","2021-05-26","2021-05-27","2021-05-28","2021-05-29","2021-05-30","2021-05-31","2021-06-01","2021-06-02","2021-06-03","2021-06-04","2021-06-05","2021-06-06","2021-06-07","2021-06-08","2021-06-09","2021-06-10","2021-06-11","2021-06-12","2021-06-13","2021-06-14","2021-06-15","2021-06-16","2021-06-17","2021-06-18","2021-06-19","2021-06-20","2021-06-21","2021-06-22","2021-06-23","2021-06-24","2021-06-25","2021-06-26","2021-06-27","2021-06-28","2021-06-29","2021-06-30","2021-07-01","2021-07-02","2021-07-03","2021-07-04","2021-07-05","2021-07-06","2021-07-07","2021-07-08","2021-07-09","2021-07-10","2021-07-11","2021-07-12","2021-07-13","2021-07-14","2021-07-15","2021-07-16","2021-07-17","2021-07-18","2021-07-19","2021-07-20","2021-07-21","2021-07-22","2021-07-23","2021-07-24","2021-07-25","2021-07-26","2021-07-27","2021-07-28","2021-07-29","2021-07-30","2021-07-31","2021-08-01","2021-08-02","2021-08-03","2021-08-04","2021-08-05","2021-08-06","2021-08-07","2021-08-08","2021-08-09","2021-08-10","2021-08-11","2021-08-12","2021-08-13","2021-08-14","2021-08-15","2021-08-16","2021-08-17","2021-08-18","2021-08-19","2021-08-20","2021-08-21","2021-08-22","2021-08-23","2021-08-24","2021-08-25","2021-08-26","2021-08-27","2021-08-28","2021-08-29","2021-08-30","2021-08-31","2021-09-01","2021-09-02","2021-09-03","2021-09-04","2021-09-05","2021-09-06","2021-09-07","2021-09-08","2021-09-09","2021-09-10","2021-09-11","2021-09-12","2021-09-13","2021-09-14","2021-09-15","2021-09-16","2021-09-17","2021-09-18","2021-09-19","2021-09-20","2021-09-21","2021-09-22","2021-09-23","2021-09-24","2021-09-25","2021-09-26","2021-09-27","2021-09-28","2021-09-29","2021-09-30","2021-10-01","2021-10-02","2021-10-03","2021-10-04","2021-10-05","2021-10-06","2021-10-07","2021-10-08","2021-10-09","2021-10-10","2021-10-11","2021-10-12","2021-10-13","2021-10-14"],"type":"candlestick"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"font":{"family":"Courier New, monospace","size":14,"color":"silver"},"xaxis":{"title":{"text":"Date"},"gridcolor":"#111","rangeslider":{"visible":false}},"yaxis":{"title":{"text":"Price (USD)"},"gridcolor":"#111"},"title":{"text":"Cardano USD (ADA-USD)"},"plot_bgcolor":"rgba(0, 0, 0, 0.0)","paper_bgcolor":"rgba(0, 0, 0, 0.0)"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('205a55f7-8ef8-4e00-aaa3-5f90462296b3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="realice-un-análisis-exploratorio-eda-para-la-serie-de-tiempo" class="level2">
<h2 class="anchored" data-anchor-id="realice-un-análisis-exploratorio-eda-para-la-serie-de-tiempo">Realice un análisis exploratorio <code>(EDA)</code> para la serie de tiempo</h2>
<p>Para realizar este ánalisis, primero debemos conocer nuestros datos y cómo se distribuyen estos. Para ello debemos el tipo de dato que tenemos para nuestras variables, el tamaño de los datos y conocer si existen valores nulos.</p>
<section id="conociendo-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="conociendo-los-datos">Conociendo los datos</h3>
<div id="094708fb" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>records_data.dtypes</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>date_        object
open         object
high         object
low          object
close        object
adj_close    object
volume       object
dtype: object</code></pre>
</div>
</div>
<p>El tipo de dato <code>Object</code> representa instancias de clases de <code>python</code> que puede tomar valores númericos, carácteres, listas, diccionarios, etc. Por lo tanto, lo que debemos realizar es convertir cada variable en su tipo de dato correspondiente.</p>
<div id="8c82885e" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'date_'</span>] <span class="op">=</span> pd.to_datetime(records_data[<span class="st">'date_'</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>columns.remove(<span class="st">'date_'</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> columns:</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    records_data[column] <span class="op">=</span> records_data[column].astype(<span class="bu">float</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>records_data <span class="op">=</span> records_data.sort_values(by<span class="op">=</span><span class="st">'date_'</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>records_data <span class="op">=</span> records_data.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>records_data.dtypes</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>date_        datetime64[ns]
open                float64
high                float64
low                 float64
close               float64
adj_close           float64
volume              float64
dtype: object</code></pre>
</div>
</div>
<p>Ahora que ya hemos asignado los tipos de datos correctos a nuestras variables podemos pasar a ver cuál es el tamaño de nuestro dataframe.</p>
<div id="819c7864" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>records_data.shape</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>(1475, 7)</code></pre>
</div>
</div>
<p>En nuestra base de datos tenemos <code>1475 filas</code> en <code>8 columnas</code>. Veamos ahora si existen datos nulos en nuestras variables,</p>
<div id="1a14da75" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>records_data.isnull().<span class="bu">sum</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>date_        0
open         4
high         4
low          4
close        4
adj_close    4
volume       4
dtype: int64</code></pre>
</div>
</div>
<p>Con esto, podemos observar que de <code>1475 filas</code> registradas en nuestra tabla, cada una de las variables correspondiendes a los precios tienen <code>4 datos faltantes</code>. Esto podría ser que los valores se encuentran en las mismas filas o no. Es importante verificarlo.</p>
<div id="ff61a3b0" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>records_data[records_data.isnull().<span class="bu">any</span>(axis <span class="op">=</span> <span class="dv">1</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date_</th>
<th data-quarto-table-cell-role="th">open</th>
<th data-quarto-table-cell-role="th">high</th>
<th data-quarto-table-cell-role="th">low</th>
<th data-quarto-table-cell-role="th">close</th>
<th data-quarto-table-cell-role="th">adj_close</th>
<th data-quarto-table-cell-role="th">volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">929</td>
<td>2020-04-17</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1104</td>
<td>2020-10-09</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1107</td>
<td>2020-10-12</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1108</td>
<td>2020-10-13</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Este código nos ha permitido saber que los <code>valores faltantes</code> se encuentran únicamente en <code>4 filas</code> de nuestra tabla. Dado que son pocos datos, y que tenemos un registro de datos grande en comparación, podríamos optar por no realizar cambios de momento. Sin embargo, en el apartado siguiente trataremos estos datos para una mayor precisión en el análisis.</p>
</section>
<section id="exploración" class="level3">
<h3 class="anchored" data-anchor-id="exploración">Exploración</h3>
<p>Luego de haber identificado nuestros datos, entendido cuáles son nuestras variables y la cantidad de valores que tenemos, podemos realizar el análisis exploratorio.</p>
<p>Inicialmente, veamos un resumen de la información que tenemos.</p>
<div id="da02c901" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>records_data.describe()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date_</th>
<th data-quarto-table-cell-role="th">open</th>
<th data-quarto-table-cell-role="th">high</th>
<th data-quarto-table-cell-role="th">low</th>
<th data-quarto-table-cell-role="th">close</th>
<th data-quarto-table-cell-role="th">adj_close</th>
<th data-quarto-table-cell-role="th">volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1475</td>
<td>1471.000000</td>
<td>1471.000000</td>
<td>1471.000000</td>
<td>1471.000000</td>
<td>1471.000000</td>
<td>1.471000e+03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2019-10-08 00:00:00</td>
<td>0.374234</td>
<td>0.393359</td>
<td>0.354385</td>
<td>0.375726</td>
<td>0.375726</td>
<td>1.090947e+09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>2017-10-01 00:00:00</td>
<td>0.018414</td>
<td>0.021050</td>
<td>0.017354</td>
<td>0.018539</td>
<td>0.018539</td>
<td>1.739460e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>2018-10-04 12:00:00</td>
<td>0.047560</td>
<td>0.049503</td>
<td>0.046073</td>
<td>0.047592</td>
<td>0.047592</td>
<td>5.366896e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>2019-10-08 00:00:00</td>
<td>0.093398</td>
<td>0.096776</td>
<td>0.090105</td>
<td>0.093434</td>
<td>0.093434</td>
<td>1.359691e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>2020-10-10 12:00:00</td>
<td>0.301339</td>
<td>0.318211</td>
<td>0.283567</td>
<td>0.301889</td>
<td>0.301889</td>
<td>6.999972e+08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>2021-10-14 00:00:00</td>
<td>2.966390</td>
<td>3.099186</td>
<td>2.907606</td>
<td>2.968239</td>
<td>2.968239</td>
<td>1.914198e+10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>NaN</td>
<td>0.609602</td>
<td>0.639195</td>
<td>0.578952</td>
<td>0.611501</td>
<td>0.611501</td>
<td>2.258370e+09</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Con esto podemos notar que las <code>desviaciones estándar</code> para nuestros valores de <code>open</code>, <code>high</code>, <code>low</code>, <code>close</code> y <code>adj_close</code> son muy similares. Esto nos puede permitir afirmar que hay <code>poca dispersión</code> entre nuestros datos relacionados al <code>precio</code>. Así como también podemos notar este comportamiento similar para los valores <code>mínimos</code>, <code>máximos</code> y <code>medios</code> de las variables. Por otro lado, la variable <code>volumen</code> parece tener una <code>dispersión alta</code>.</p>
</section>
<section id="limpieza-de-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="limpieza-de-los-datos">Limpieza de los datos</h3>
<p>En este apartado trataremos los datos faltantes y observaremos si existen datos atípicos en nuestras variables.</p>
<section id="datos-faltantes" class="level4">
<h4 class="anchored" data-anchor-id="datos-faltantes">Datos faltantes</h4>
<p>Existen distintas formas de tratar este problema. Una forma efectiva podría ser utilizar una <code>imputación</code> en los datos faltantes mediante puntos similares en los datos mediante el <code>algoritmo KNN</code>. Sin embargo, para casos como el nuestro, que tenemos pocos datos faltantes, podemos utilizar imputación mediante el valor de la <code>media/moda/mediana</code> o llenar los datos mediante los valores <code>anteriores o siguientes</code>, el cual será el que usaremos en esta situación.</p>
<div id="a8448a77" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'open'</span>] <span class="op">=</span> records_data[<span class="st">'open'</span>].ffill()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'close'</span>] <span class="op">=</span> records_data[<span class="st">'close'</span>].ffill()</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'high'</span>] <span class="op">=</span> records_data[<span class="st">'high'</span>].ffill()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'low'</span>] <span class="op">=</span> records_data[<span class="st">'low'</span>].ffill()</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'volume'</span>] <span class="op">=</span> records_data[<span class="st">'volume'</span>].ffill()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'adj_close'</span>] <span class="op">=</span> records_data[<span class="st">'adj_close'</span>].ffill()</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>records_data.isnull().<span class="bu">sum</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>date_        0
open         0
high         0
low          0
close        0
adj_close    0
volume       0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="datos-atípicos" class="level4">
<h4 class="anchored" data-anchor-id="datos-atípicos">Datos atípicos</h4>
<p>Veamos ahora si existen <code>datos atípicos</code> en nuestro registro. En este caso lo veremos mediante el <code>rango intercuartílico</code> donde si un valor cae por debajo de <code>Q1 - 1.5 * IQR</code> o por encima de <code>Q3 + 1.5 * IQR</code> son potenciales datos atípicos.</p>
<div id="9cbc9f31" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> records_data.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>]).columns</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    q1 <span class="op">=</span> records_data[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    q3 <span class="op">=</span> records_data[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    iqr <span class="op">=</span> q3 <span class="op">-</span> q1</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> iqr</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> iqr</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    outliers <span class="op">=</span> records_data[(records_data[col] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (records_data[col] <span class="op">&gt;</span> upper_bound)]</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    n_outliers <span class="op">=</span> <span class="bu">len</span>(outliers)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'Number of outliers in </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss"> are </span><span class="sc">{</span>n_outliers<span class="sc">}</span><span class="ss"> and represent a </span><span class="sc">{</span><span class="bu">round</span>(n_outliers<span class="op">/</span><span class="bu">len</span>(records_data) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">4</span>)<span class="sc">}</span><span class="ss">% of total records'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of outliers in open are 265 and represent a 17.9661% of total records
Number of outliers in high are 267 and represent a 18.1017% of total records
Number of outliers in low are 264 and represent a 17.8983% of total records
Number of outliers in close are 266 and represent a 18.0339% of total records
Number of outliers in adj_close are 266 and represent a 18.0339% of total records
Number of outliers in volume are 276 and represent a 18.7119% of total records</code></pre>
</div>
</div>
<p>Como podemos observar tenemos una cantidad significativa de datos atípicos en cada una de nuestras variables, esto podría afectar más adelante en los modelos estadísticos que querramos implementar. Veamos gráficamente qué es lo que está ocurriendo con ello.</p>
<p>Realizaremos un gráfico de <code>caja y bigotes</code> e <code>histogramas</code> para ver el comportamiento y la distribución de nuestros datos.</p>
<div id="cell-data-boxplot" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">20</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">5</span>,<span class="dv">3</span>,i)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    plt.boxplot(records_data[col],whis<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    plt.title(col)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tarea2_files/figure-html/data-boxplot-output-1.png" width="791" height="621" class="figure-img"></p>
<figcaption>Boxplot de las variables de la tabla Cardano USD</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-data-hist" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">20</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">5</span>, <span class="dv">3</span>, i)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    sns.histplot(records_data[col], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    plt.title(col)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tarea2_files/figure-html/data-hist-output-1.png" width="950" height="782" class="figure-img"></p>
<figcaption>Histograma de las variables de la tabla Cardano USD</figcaption>
</figure>
</div>
</div>
</div>
<p>Viendo las gráficas de <code>histogramas</code> y <code>boxplots</code>, podemos observar que nuestras variables tienen una distribución y estructura similar. Sin embargo, como hemos notado en un inicio, los rangos mínimos y máximos que toman nuestros datos difieren entre <code>Volume</code> y el resto. Esta diferencia tan grande puede afectar <code>negativamente</code> los modelos y análisis planteados pues, esta variable puede dominar sobre las demás debido a las escalas. Por esto, realizaremos una <code>normalización</code> de la variable <code>Volume</code> para tener una escala similar a las demás variables. En este caso, usaremos el <code>método de escalado mediante mínimos y máximos</code>, donde nuestro valor mínimo a tomar será 0 y el máximo será 3, teniendo en cuenta que es el valor por el que las demás variables rondan como máximo también. Para ello, usaremos la librería <code>Scikit-learn</code></p>
<div id="cc7f883f" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>records_data[<span class="st">'volume'</span>] <span class="op">=</span> scaler.fit_transform(records_data[[<span class="st">'volume'</span>]])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c6773d9e" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">20</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric_columns:</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">5</span>, <span class="dv">3</span>, i)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    sns.histplot(records_data[col], kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    plt.title(col)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tarea2_files/figure-html/cell-33-output-1.png" width="950" height="782" class="figure-img"></p>
<figcaption>Histograma de las variables de la tabla Cardano USD, transformando la variable Volume</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="visualización" class="level3">
<h3 class="anchored" data-anchor-id="visualización">Visualización</h3>
<p>Ahora, veamos gráficamente las relaciones que hay entre nuestros datos mediante gráficos de <code>correlación</code> y gráficos de <code>dispersión en parejas</code>.</p>
<div id="2911fd8d" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> records_data[numeric_columns].corr()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(corr, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>, square<span class="op">=</span><span class="va">True</span>, center<span class="op">=</span><span class="dv">0</span>, mask<span class="op">=</span>mask)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tarea2_files/figure-html/cell-34-output-1.png" width="490" height="415" class="figure-img"></p>
<figcaption>Correlación entre las variables de la base de datos</figcaption>
</figure>
</div>
</div>
</div>
<p>Podemos notar que las variables de <code>open</code>, <code>high</code>, <code>low</code> y <code>close</code> están completamente correlacionados. Sin embargo, esto era claro debido a los valores similares que hay entre ellos y que, estos valores dependen unos de otros en la mayor parte del tiempo, cuando hablamos de valores de la bolsa.</p>
<p>Veamos ahora el gráfico de dispersión por pareja de variables.</p>
<div id="0b79290c" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(records_data[numeric_columns])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="tarea2_files/figure-html/cell-35-output-1.png" width="1417" height="1417" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Con esto, podemos ver resultados similares a los obtenidos en el mapa de calor de la correlación entre variables. Debemos notar que la variable de <code>adj_close</code>, ajuste del precio de cierre, y <code>close</code>, precio de cierre, son muy similares, y casi que no hay variación entre ellas. Sin embargo, las otras variables tienen cierta diferencia notoria entre sus valores.</p>
<p>Luego de haber realizado este análisis podríamos pasar a nuestro siguiente etapa, planteamiento de modelos de clasificación, pronósticos u otros análisis.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="tarea2_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>